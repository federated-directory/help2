import{_ as a,o as t,c as s,ag as i}from"./chunks/framework.Q1EpFJIG.js";const c=JSON.parse('{"title":"Obtaining a token","description":"","frontmatter":{},"headers":[],"relativePath":"developer/obtaining-a-token.md","filePath":"developer/obtaining-a-token.md"}'),n={name:"developer/obtaining-a-token.md"};function r(o,e,l,h,p,d){return t(),s("div",null,[...e[0]||(e[0]=[i(`<h1 id="obtaining-a-token" tabindex="-1">Obtaining a token <a class="header-anchor" href="#obtaining-a-token" aria-label="Permalink to &quot;Obtaining a token&quot;">​</a></h1><p>Any service or application that wants to integrate with the Federated Directory APIs needs to obtain an access token. This access token should be placed in the <code>Authorization</code> header of every API call as a Bearer token. Like this:</p><pre><code>Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
</code></pre><p>In this chapter we will explain in more detail:</p><ul><li>The different <a href="#audiences-and-roles">audiences and roles</a> of access tokens and their impact</li><li>How to <a href="#retrieve-an-access-token-with-a-key">retrieve an access token with a key</a></li></ul><h2 id="audiences-and-roles" tabindex="-1">Audiences and roles <a class="header-anchor" href="#audiences-and-roles" aria-label="Permalink to &quot;Audiences and roles&quot;">​</a></h2><p>The combination of an audience (aud) and a role describe the authorizations of an access token.</p><p>An audience basically says for what kind of user the access token was created.</p><table tabindex="0"><thead><tr><th style="text-align:left;">Audience</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;">User</td><td style="text-align:left;">A user represents a person and is contained in a user directory. It&#39;s main purpose is for the usage of the platform by a person.</td></tr><tr><td style="text-align:left;">Key</td><td style="text-align:left;">A key is not linked to a natural person and is mainly intended for system integration. There are two kind of keys: a directory key and a admin key. Both have a different role.</td></tr></tbody></table><p>A role determines the authorizations given to an access token.</p><table tabindex="0"><thead><tr><th style="text-align:left;">Role</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;">User</td><td style="text-align:left;">Is not able to make changes to any other user in or the configuration in its company</td></tr><tr><td style="text-align:left;">directoryKey</td><td style="text-align:left;">Always a key (audience) that has admin permissions on one specific directory in your Federated Directory. Ideal for integration with your current corporate address book or IAM solution (like Azure AD, Google Directory or Okta)</td></tr><tr><td style="text-align:left;">admin</td><td style="text-align:left;">Full administrative permissions. Can modify all users and settings in its company</td></tr></tbody></table><h2 id="retrieve-an-access-token-with-a-key" tabindex="-1">Retrieve an access token with a key <a class="header-anchor" href="#retrieve-an-access-token-with-a-key" aria-label="Permalink to &quot;Retrieve an access token with a key&quot;">​</a></h2><p>There are two sort of keys.</p><ol><li><a href="#create-a-directory-key">Directory key</a> (role = directoryKey)</li><li><a href="#create-an-api-key">API key</a> (role = admin)</li></ol><p>Decide which key is appropriate for your integration scenario.</p><h3 id="create-a-directory-key" tabindex="-1">Create a directory key <a class="header-anchor" href="#create-a-directory-key" aria-label="Permalink to &quot;Create a directory key&quot;">​</a></h3><p>Go to &#39;directories&#39; and select the directory you want to integrate with. Go to the &quot;KEYS&quot; tab and create a new key.</p><p>After the key has been created you will receive three things:</p><ol><li>issuer</li><li>private key</li><li>access token</li></ol><p>The access token is only returned directly after you create the key. This access token is valid for many years. So keep it secure!</p><p>The &#39;issuer&#39; and &#39;private key&#39; can be used to <a href="#create-an-access-token-with-the-issuer-and-private-key">create access tokens</a>. These tokens have the same lifetime as a user session. This is <a href="/administrator/company.html">configurable per tenant</a> but has a default value of 480 minutes (8 hours).</p><h3 id="create-an-api-key" tabindex="-1">Create an API key <a class="header-anchor" href="#create-an-api-key" aria-label="Permalink to &quot;Create an API key&quot;">​</a></h3><p>An API key has the same permissions as a user with the &#39;administrator&#39; role.</p><p>To create such a key, go to &#39;integrations&#39; in the menu and create a new key.</p><p>After the key has been created you will receive two things:</p><ol><li>issuer</li><li>private key</li></ol><p>The &#39;issuer&#39; and &#39;private key&#39; can be used to <a href="#create-an-access-token-with-the-issuer-and-private-key">create access tokens</a>. These tokens have the same lifetime as a user session. This is <a href="/administrator/company.html">configurable per tenant</a> but has a default value of 480 minutes (8 hours).</p><h2 id="create-an-access-token-with-the-issuer-and-private-key" tabindex="-1">Create an access token with the issuer and private key <a class="header-anchor" href="#create-an-access-token-with-the-issuer-and-private-key" aria-label="Permalink to &quot;Create an access token with the issuer and private key&quot;">​</a></h2><p>Place the &#39;issuer&#39; value of your key in the below JSON.</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;iss&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;issuer&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;scope&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;directoryKey&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// [&quot;admin&quot;] if this is the API key and not Directory key</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;aud&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;key&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Use RS256 encryption to create and parse a JWT token. Use your &#39;private key&#39; for this. There are a <a href="https://jwt.io/libraries" target="_blank" rel="noreferrer">a lot of libraries</a> available that can do this.</p><p>This JWT can then be submitted by a POST action to this end-point :</p><table tabindex="0"><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>method</td><td>POST</td></tr><tr><td>url</td><td><a href="https://api.federated.directory/v2/Login/Oauth2/Token" target="_blank" rel="noreferrer">https://api.federated.directory/v2/Login/Oauth2/Token</a></td></tr><tr><td>body</td><td>See below</td></tr></tbody></table><h3 id="body" tabindex="-1">Body <a class="header-anchor" href="#body" aria-label="Permalink to &quot;Body&quot;">​</a></h3><p>The JWT needs to be called &quot;assertion&quot; in the final payload :</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;grant_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:ietf:params:oauth:grant-type:jwt-bearer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;assertion&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;JWT&gt;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="example-request" tabindex="-1">Example Request <a class="header-anchor" href="#example-request" aria-label="Permalink to &quot;Example Request&quot;">​</a></h2><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;grant_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:ietf:params:oauth:grant-type:jwt-bearer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;assertion&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI1MWYxZTY1NmVsa3YzMXlwdXlmMWVlemlhd3VzbDM5a0BmZCIsInNjb3BlIjpbImFkbWluIl0sImF1ZCI6ImtleSJ9.NTcYu4kNx6xw7YeTuG0fEOgFccPco9oyDT1KcK5QLLT26_3VhF7kRTuHxDxxBrMjNDlb2RxkEXN0a3buME0lYDUoEcsooQlVCgH1teZsg8lzr4LdYmvY0j2EEH5FlkHDHRxejrstbGajlespxnFTK0c8t31sROaNMnKYBpwyf7I&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="example-response" tabindex="-1">Example Response <a class="header-anchor" href="#example-response" aria-label="Permalink to &quot;Example Response&quot;">​</a></h2><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;access_token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL3d3dy5mZWRlcmF0ZWQuZGlyZWN0b3J5LyIsImF1ZCI6ImtleSIsImV4cCI6MTYwMjQ1ODg2OCwianRpIjoiN2RhNGUwYzAtZmRjYS0xMWVhLWEwZmEtNDdjMmFmMzE5YmU0In0.GIrdUmIccnFBTGKUmlLLOtIEGxqUL3uJ54yG1SJYGyo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;token_type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Bearer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;expires_in&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28800</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>You can use this token by including it in the header of any following request as: <br><code>&quot;Authorization&quot; : &quot;Bearer &lt;access_token&gt;&quot;</code></p>`,41)])])}const y=a(n,[["render",r]]);export{c as __pageData,y as default};
