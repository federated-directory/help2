<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Obtaining a token - Federated Directory</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-5FT2Y1PF6Z"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-5FT2Y1PF6Z', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Obtaining a token | Federated Directory</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Obtaining a token" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="https://help.federated.directory/developer/obtaining-a-token.html" /> <meta property="og:url" content="https://help.federated.directory/developer/obtaining-a-token.html" /> <meta property="og:site_name" content="Federated Directory" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Obtaining a token" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Obtaining a token","url":"https://help.federated.directory/developer/obtaining-a-token.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://help.federated.directory/" class="site-title lh-tight"><div class=site-logo> <!-- <img alt="logo" src="/assets/images/FederatedDirectory_logo.svg"> --> </div> <!-- Cloudflare Web Analytics --> <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "0fcf87fd8af848d6abbe256323c53378"}'></script><!-- End Cloudflare Web Analytics --></a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://help.federated.directory/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="https://help.federated.directory/getting-started.html" class="nav-list-link">Getting started</a></li><li class="nav-list-item"><a href="https://help.federated.directory/login.html" class="nav-list-link">Login</a></li><li class="nav-list-item"><a href="https://help.federated.directory/search.html" class="nav-list-link">Search</a></li><li class="nav-list-item"><a href="https://help.federated.directory/myaccount.html" class="nav-list-link">My Account</a></li><li class="nav-list-item"><a href="https://help.federated.directory/groups.html" class="nav-list-link">Groups</a></li><li class="nav-list-item"><a href="https://help.federated.directory/outlook-add-in.html" class="nav-list-link">Microsoft Outlook add-in</a></li><li class="nav-list-item"><a href="https://help.federated.directory/teams-app.html" class="nav-list-link">Microsoft Teams app</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://help.federated.directory/administrator/administrator.html" class="nav-list-link">Administrator</a><ul class="nav-list "><li class="nav-list-item "><a href="https://help.federated.directory/administrator/company.html" class="nav-list-link">Company</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/directories.html" class="nav-list-link">Directories</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/integrations.html" class="nav-list-link">Integrations</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/auditlogs.html" class="nav-list-link">Audit logs</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/google.html" class="nav-list-link">Integrate with Google</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/microsoft.html" class="nav-list-link">Integrate with Microsoft</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/okta.html" class="nav-list-link">Integrate with Okta</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/onelogin.html" class="nav-list-link">Integrate with OneLogin</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/oidc.html" class="nav-list-link">Integrate with OIDC</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/saml.html" class="nav-list-link">Integrate with SAML 2.0</a></li><li class="nav-list-item "><a href="https://help.federated.directory/administrator/scim.html" class="nav-list-link">Integrate with SCIM 2.0</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://help.federated.directory/developer/developer.html" class="nav-list-link">Developer</a><ul class="nav-list "><li class="nav-list-item "><a href="https://help.federated.directory/developer/getting-started.html" class="nav-list-link">Getting started</a></li><li class="nav-list-item active"><a href="https://help.federated.directory/developer/obtaining-a-token.html" class="nav-list-link active">Obtaining a token</a></li><li class="nav-list-item "><a href="https://help.federated.directory/developer/users-api.html" class="nav-list-link">Users API</a></li><li class="nav-list-item "><a href="https://help.federated.directory/developer/design-principles.html" class="nav-list-link">Design Principles</a></li></ul></li><li class="nav-list-item"><a href="https://help.federated.directory/contact-us.html" class="nav-list-link">Contact Us</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Federated Directory" aria-label="Search Federated Directory" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://help.federated.directory/developer/developer.html">Developer</a></li> <li class="breadcrumb-nav-list-item"><span>Obtaining a token</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="obtaining-a-token"> <a href="#obtaining-a-token" class="anchor-heading" aria-labelledby="obtaining-a-token"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Obtaining a token </h1> <p>Any service or application that wants to integrate with the Federated Directory APIs needs to obtain an access token. This access token should be placed in the <code class="language-plaintext highlighter-rouge">Authorization</code> header of every API call as a Bearer token. Like this:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
</code></pre></div></div> <p>In this chapter we will explain in more detail:</p> <ul> <li>The different <a href="#audiences-and-roles">audiences and roles</a> of access tokens and their impact</li> <li>How to <a href="#retrieve-an-access-token-with-a-key">retrieve an access token with a key</a></li> </ul> <h2 id="audiences-and-roles"> <a href="#audiences-and-roles" class="anchor-heading" aria-labelledby="audiences-and-roles"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Audiences and roles </h2> <p>The combination of an audience (aud) and a role describe the authorizations of an access token.</p> <p>An audience basically says for what kind of user the access token was created.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Audience</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">User</td> <td style="text-align: left">A user represents a person and is contained in a user directory. It’s main purpose is for the usage of the platform by a person.</td> </tr> <tr> <td style="text-align: left">Key</td> <td style="text-align: left">A key is not linked to a natural person and is mainly intended for system integration. There are two kind of keys: a directory key and a admin key. Both have a different role.</td> </tr> </tbody> </table></div> <p>A role determines the authorizations given to an access token.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Role</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">User</td> <td style="text-align: left">Is not able to make changes to any other user in or the configuration in its company</td> </tr> <tr> <td style="text-align: left">directoryKey</td> <td style="text-align: left">Always a key (audience) that has admin permissions on one specific directory in your Federated Directory. Ideal for integration with your current corporate address book or IAM solution (like Azure AD, Google Directory or Okta)</td> </tr> <tr> <td style="text-align: left">admin</td> <td style="text-align: left">Full administrative permissions. Can modify all users and settings in its company</td> </tr> </tbody> </table></div> <h2 id="retrieve-an-access-token-with-a-key"> <a href="#retrieve-an-access-token-with-a-key" class="anchor-heading" aria-labelledby="retrieve-an-access-token-with-a-key"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Retrieve an access token with a key </h2> <p>There are two sort of keys.</p> <ol> <li><a href="#create-a-directory-key">Directory key</a> (role = directoryKey)</li> <li><a href="#create-an-api-key">API key</a> (role = admin)</li> </ol> <p>Decide which key is appropriate for your integration scenario.</p> <h3 id="create-a-directory-key"> <a href="#create-a-directory-key" class="anchor-heading" aria-labelledby="create-a-directory-key"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create a directory key </h3> <p>Go to ‘directories’ and select the directory you want to integrate with. Go to the “KEYS” tab and create a new key.</p> <p>After the key has been created you will receive three things:</p> <ol> <li>issuer</li> <li>private key</li> <li>access token</li> </ol> <p>The access token is only returned directly after you create the key. This access token is valid for many years. So keep it secure!</p> <p>The ‘issuer’ and ‘private key’ can be used to <a href="#create-an-access-token-with-the-issuer-and-private-key">create access tokens</a>. These tokens have the same lifetime as a user session. This is <a href="/administrator/company">configurable per tenant</a> but has a default value of 480 minutes (8 hours).</p> <h3 id="create-an-api-key"> <a href="#create-an-api-key" class="anchor-heading" aria-labelledby="create-an-api-key"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create an API key </h3> <p>An API key has the same permissions as a user with the ‘administrator’ role.</p> <p>To create such a key, go to ‘integrations’ in the menu and create a new key.</p> <p>After the key has been created you will receive two things:</p> <ol> <li>issuer</li> <li>private key</li> </ol> <p>The ‘issuer’ and ‘private key’ can be used to <a href="#create-an-access-token-with-the-issuer-and-private-key">create access tokens</a>. These tokens have the same lifetime as a user session. This is <a href="/administrator/company">configurable per tenant</a> but has a default value of 480 minutes (8 hours).</p> <h2 id="create-an-access-token-with-the-issuer-and-private-key"> <a href="#create-an-access-token-with-the-issuer-and-private-key" class="anchor-heading" aria-labelledby="create-an-access-token-with-the-issuer-and-private-key"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create an access token with the issuer and private key </h2> <p>Place the ‘issuer’ value of your key in the below JSON.</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"iss"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;issuer&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scope"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"directoryKey"</span><span class="p">],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span><span class="w"> </span><span class="err">if</span><span class="w"> </span><span class="err">this</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">API</span><span class="w"> </span><span class="err">key</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">not</span><span class="w"> </span><span class="err">Directory</span><span class="w"> </span><span class="err">key</span><span class="w">
  </span><span class="nl">"aud"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Use RS256 encryption to create and parse a JWT token. Use your ‘private key’ for this. There are a <a href="https://jwt.io/libraries">a lot of libraries</a> available that can do this.</p> <p>This JWT can then be submitted by a POST action to this end-point :</p> <div class="table-wrapper"><table> <thead> <tr> <th> </th> <th> </th> </tr> </thead> <tbody> <tr> <td>method</td> <td>POST</td> </tr> <tr> <td>url</td> <td>ht<span>tps://api.federated.directory/v2/Login/Oauth2/Token</span></td> </tr> <tr> <td>body</td> <td>See below</td> </tr> </tbody> </table></div> <h3 id="body"> <a href="#body" class="anchor-heading" aria-labelledby="body"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Body </h3> <p>The JWT needs to be called “assertion” in the final payload :</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"grant_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"urn:ietf:params:oauth:grant-type:jwt-bearer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assertion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;JWT&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="example-request"> <a href="#example-request" class="anchor-heading" aria-labelledby="example-request"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example Request </h2> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"grant_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"urn:ietf:params:oauth:grant-type:jwt-bearer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assertion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI1MWYxZTY1NmVsa3YzMXlwdXlmMWVlemlhd3VzbDM5a0BmZCIsInNjb3BlIjpbImFkbWluIl0sImF1ZCI6ImtleSJ9.NTcYu4kNx6xw7YeTuG0fEOgFccPco9oyDT1KcK5QLLT26_3VhF7kRTuHxDxxBrMjNDlb2RxkEXN0a3buME0lYDUoEcsooQlVCgH1teZsg8lzr4LdYmvY0j2EEH5FlkHDHRxejrstbGajlespxnFTK0c8t31sROaNMnKYBpwyf7I"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="example-response"> <a href="#example-response" class="anchor-heading" aria-labelledby="example-response"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example Response </h2> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL3d3dy5mZWRlcmF0ZWQuZGlyZWN0b3J5LyIsImF1ZCI6ImtleSIsImV4cCI6MTYwMjQ1ODg2OCwianRpIjoiN2RhNGUwYzAtZmRjYS0xMWVhLWEwZmEtNDdjMmFmMzE5YmU0In0.GIrdUmIccnFBTGKUmlLLOtIEGxqUL3uJ54yG1SJYGyo"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">28800</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>You can use this token by including it in the header of any following request as: <br /> <code class="language-plaintext highlighter-rouge">"Authorization" : "Bearer &lt;access_token&gt;"</code></p> <hr> <footer> Copyright &copy; 2024 <a href="https://www.federated.directory">Federated Directory</a>. </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
