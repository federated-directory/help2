{
  "version": 3,
  "sources": ["../../../../../src/httpsnippet-lite/targets/go/native/client.ts"],
  "sourcesContent": ["/**\n * @description\n * HTTP code snippet generator for native Go.\n *\n * @author\n * @montanaflynn\n *\n * for any questions or issues regarding the generated code snippet, please open an issue mentioning the author.\n */\n\nimport { CodeBuilder } from '@/httpsnippet-lite/helpers/code-builder'\nimport { escapeForDoubleQuotes } from '@/httpsnippet-lite/helpers/escape'\nimport type { Client } from '@/httpsnippet-lite/targets/target'\n\nexport const native: Client = {\n  info: {\n    key: 'native',\n    title: 'NewRequest',\n    link: 'http://golang.org/pkg/net/http/#NewRequest',\n    description: 'Golang HTTP client request',\n  },\n  convert: ({ postData, method, allHeaders, fullUrl }, options = {}) => {\n    const { blank, push, join, addPostProcessor } = new CodeBuilder({ indent: '\\t' })\n    const {\n      showBoilerplate = true,\n      checkErrors = false,\n      printBody = true,\n      timeout = -1,\n      insecureSkipVerify = false,\n    } = options\n    const errorPlaceholder = checkErrors ? 'err' : '_'\n    const indent = showBoilerplate ? 1 : 0\n    const errorCheck = () => {\n      if (checkErrors) {\n        push('if err != nil {', indent)\n        push('panic(err)', indent + 1)\n        push('}', indent)\n      }\n    }\n    // Create boilerplate\n    const imports = new Set()\n    if (showBoilerplate) {\n      push('package main')\n      blank()\n\n      push('import ()')\n      addPostProcessor((code) => {\n        const importArray = [...imports]\n        importArray.sort()\n        const importBlock = importArray.map((line) => `\\t\"${line}\"`).join('\\n')\n        return code.replace(/import \\(\\)/, `import (\\n${importBlock}\\n)`)\n      })\n\n      imports.add('fmt')\n      imports.add('net/http')\n\n      blank()\n      push('func main() {')\n    }\n    // Create an insecure transport for the client\n    if (insecureSkipVerify) {\n      imports.add('crypto/tls')\n      push('insecureTransport := http.DefaultTransport.(*http.Transport).Clone()', indent)\n      push('insecureTransport.TLSClientConfig = &tls.Config{InsecureSkipVerify: true}', indent)\n    }\n    // Create client\n    const hasTimeout = timeout > 0\n    const hasClient = hasTimeout || insecureSkipVerify\n    const client = hasClient ? 'client' : 'http.DefaultClient'\n    if (hasClient) {\n      push('client := http.Client{', indent)\n      if (hasTimeout) {\n        imports.add('time')\n        push(`Timeout: time.Duration(${timeout} * time.Second),`, indent + 1)\n      }\n      if (insecureSkipVerify) {\n        push('Transport: insecureTransport,', indent + 1)\n      }\n      push('}', indent)\n      blank()\n    }\n    push(`url := \"${fullUrl}\"`, indent)\n    blank()\n    // If we have body content or not create the var and reader or nil\n    if (postData !== null && postData !== void 0 && (postData.params || postData.text)) {\n      if (postData.mimeType === 'application/x-www-form-urlencoded' && postData.params) {\n        imports.add('net/url')\n        imports.add('strings')\n\n        push('postData := url.Values{}', indent)\n        postData.params.forEach((param) => {\n          push(`postData.Set(\"${param.name}\", \"${escapeForDoubleQuotes(param.value as string)}\")`, indent)\n        })\n        blank()\n        push(\n          `req, ${errorPlaceholder} := http.NewRequest(\"${method}\", url, strings.NewReader(postData.Encode()))`,\n          indent,\n        )\n      } else if (postData.mimeType === 'multipart/form-data' && postData.params) {\n        imports.add('bytes')\n        imports.add('mime/multipart')\n\n        push('payload := &bytes.Buffer{}', indent)\n        push('writer := multipart.NewWriter(payload)', indent)\n        postData.params.forEach((param) => {\n          blank()\n          if (param.fileName) {\n            push(`part, ${errorPlaceholder} := writer.CreateFormFile(\"${param.name}\", \"${param.fileName}\")`, indent)\n            errorCheck()\n            blank()\n            push(`f, ${errorPlaceholder} := os.Open(\"${param.fileName}\")`, indent)\n            errorCheck()\n            push('defer f.Close()', indent)\n            blank()\n            push(`_, ${errorPlaceholder} = io.Copy(part, f)`, indent)\n            errorCheck()\n          } else {\n            push(\n              `${errorPlaceholder} = writer.WriteField(\"${param.name}\", \"${escapeForDoubleQuotes(param.value as string)}\")`,\n              indent,\n            )\n            errorCheck()\n          }\n        })\n        push('writer.Close()', indent)\n        blank()\n        push(`req, ${errorPlaceholder} := http.NewRequest(\"${method}\", url, payload)`, indent)\n      } else {\n        imports.add('strings')\n\n        push(`payload := strings.NewReader(${JSON.stringify(postData.text)})`, indent)\n        blank()\n        push(`req, ${errorPlaceholder} := http.NewRequest(\"${method}\", url, payload)`, indent)\n      }\n    } else {\n      push(`req, ${errorPlaceholder} := http.NewRequest(\"${method}\", url, nil)`, indent)\n    }\n    errorCheck()\n    blank()\n    // Add headers\n    if (postData !== null && postData !== void 0 && postData.mimeType === 'multipart/form-data' && postData.params) {\n      push(`req.Header.Set(\"Content-Type\", writer.FormDataContentType())`, indent)\n    }\n    if (Object.keys(allHeaders).length) {\n      Object.keys(allHeaders).forEach((key) => {\n        push(`req.Header.Add(\"${key}\", \"${escapeForDoubleQuotes(allHeaders[key] as string)}\")`, indent)\n      })\n      blank()\n    }\n    // Make request\n    push(`res, ${errorPlaceholder} := ${client}.Do(req)`, indent)\n    errorCheck()\n    // Get Body\n    if (printBody) {\n      imports.add('io')\n      blank()\n      push('defer res.Body.Close()', indent)\n      push(`body, ${errorPlaceholder} := io.ReadAll(res.Body)`, indent)\n      errorCheck()\n    }\n    // Print it\n    blank()\n    push('fmt.Println(res)', indent)\n    if (printBody) {\n      push('fmt.Println(string(body))', indent)\n    }\n    // End main block\n    if (showBoilerplate) {\n      blank()\n      push('}')\n    }\n    return join()\n  },\n}\n"],
  "mappings": "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",
  "names": []
}
