{
  "version": 3,
  "sources": ["../../../../src/httpsnippet-lite/targets/powershell/common.ts"],
  "sourcesContent": ["import { CodeBuilder } from '@/httpsnippet-lite/helpers/code-builder'\nimport { escapeString } from '@/httpsnippet-lite/helpers/escape'\nimport { getHeader } from '@/httpsnippet-lite/helpers/headers'\nimport type { Converter } from '@/httpsnippet-lite/targets/target'\n\nexport const generatePowershellConvert = (command: string): Converter<Record<string, any>> => {\n  const convert: Converter<Record<string, any>> = ({\n    method,\n    headersObj,\n    cookies,\n    uriObj,\n    fullUrl,\n    postData,\n    allHeaders,\n  }) => {\n    const { push, join } = new CodeBuilder()\n    const methods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS']\n    if (!methods.includes(method.toUpperCase())) {\n      return 'Method not supported'\n    }\n    const commandOptions = []\n    // Add headers, including the cookies\n    const headers = Object.keys(headersObj)\n    // construct headers\n    if (headers.length) {\n      push('$headers=@{}')\n      headers.forEach((key) => {\n        if (key !== 'connection') {\n          // Not allowed\n          push(`$headers.Add(\"${key}\", \"${escapeString(headersObj[key] as string, { escapeChar: '`' })}\")`)\n        }\n      })\n      commandOptions.push('-Headers $headers')\n    }\n    // construct cookies\n    if (cookies.length) {\n      push('$session = New-Object Microsoft.PowerShell.Commands.WebRequestSession')\n      cookies.forEach((cookie) => {\n        push('$cookie = New-Object System.Net.Cookie')\n        push(`$cookie.Name = '${cookie.name}'`)\n        push(`$cookie.Value = '${cookie.value}'`)\n        push(`$cookie.Domain = '${uriObj.host}'`)\n        push('$session.Cookies.Add($cookie)')\n      })\n      commandOptions.push('-WebSession $session')\n    }\n    if (postData === null || postData === void 0 ? void 0 : postData.text) {\n      commandOptions.push(\n        `-ContentType '${escapeString(getHeader(allHeaders, 'content-type') as string, {\n          delimiter: \"'\",\n          escapeChar: '`',\n        })}'`,\n      )\n      commandOptions.push(`-Body '${postData!.text}'`)\n    }\n    push(`$response = ${command} -Uri '${fullUrl}' -Method ${method} ${commandOptions.join(' ')}`)\n    return join()\n  }\n  return convert\n}\n"],
  "mappings": "AAAA,SAAS,mBAAmB;AAC5B,SAAS,oBAAoB;AAC7B,SAAS,iBAAiB;AAGnB,MAAM,4BAA4B,CAAC,YAAoD;AAC5F,QAAM,UAA0C,CAAC;AAAA,IAC/C;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,MAAM;AACJ,UAAM,EAAE,MAAM,KAAK,IAAI,IAAI,YAAY;AACvC,UAAM,UAAU,CAAC,OAAO,QAAQ,OAAO,UAAU,SAAS,QAAQ,SAAS;AAC3E,QAAI,CAAC,QAAQ,SAAS,OAAO,YAAY,CAAC,GAAG;AAC3C,aAAO;AAAA,IACT;AACA,UAAM,iBAAiB,CAAC;AAExB,UAAM,UAAU,OAAO,KAAK,UAAU;AAEtC,QAAI,QAAQ,QAAQ;AAClB,WAAK,cAAc;AACnB,cAAQ,QAAQ,CAAC,QAAQ;AACvB,YAAI,QAAQ,cAAc;AAExB,eAAK,iBAAiB,GAAG,OAAO,aAAa,WAAW,GAAG,GAAa,EAAE,YAAY,IAAI,CAAC,CAAC,IAAI;AAAA,QAClG;AAAA,MACF,CAAC;AACD,qBAAe,KAAK,mBAAmB;AAAA,IACzC;AAEA,QAAI,QAAQ,QAAQ;AAClB,WAAK,uEAAuE;AAC5E,cAAQ,QAAQ,CAAC,WAAW;AAC1B,aAAK,wCAAwC;AAC7C,aAAK,mBAAmB,OAAO,IAAI,GAAG;AACtC,aAAK,oBAAoB,OAAO,KAAK,GAAG;AACxC,aAAK,qBAAqB,OAAO,IAAI,GAAG;AACxC,aAAK,+BAA+B;AAAA,MACtC,CAAC;AACD,qBAAe,KAAK,sBAAsB;AAAA,IAC5C;AACA,QAAI,aAAa,QAAQ,aAAa,SAAS,SAAS,SAAS,MAAM;AACrE,qBAAe;AAAA,QACb,iBAAiB,aAAa,UAAU,YAAY,cAAc,GAAa;AAAA,UAC7E,WAAW;AAAA,UACX,YAAY;AAAA,QACd,CAAC,CAAC;AAAA,MACJ;AACA,qBAAe,KAAK,UAAU,SAAU,IAAI,GAAG;AAAA,IACjD;AACA,SAAK,eAAe,OAAO,UAAU,OAAO,aAAa,MAAM,IAAI,eAAe,KAAK,GAAG,CAAC,EAAE;AAC7F,WAAO,KAAK;AAAA,EACd;AACA,SAAO;AACT;",
  "names": []
}
