{
  "version": 3,
  "sources": ["../../../../../src/httpsnippet-lite/targets/c/libcurl/client.ts"],
  "sourcesContent": ["import { CodeBuilder } from '@/httpsnippet-lite/helpers/code-builder'\nimport { escapeForDoubleQuotes } from '@/httpsnippet-lite/helpers/escape'\nimport type { Client } from '@/httpsnippet-lite/targets/target'\nimport { createSearchParams } from '@/libs/http'\n\nexport const libcurl: Client = {\n  info: {\n    key: 'libcurl',\n    title: 'Libcurl',\n    link: 'http://curl.haxx.se/libcurl',\n    description: 'Simple REST and HTTP API Client for C',\n  },\n  convert: ({ method, fullUrl, headersObj, allHeaders, postData }) => {\n    const { push, blank, join } = new CodeBuilder({ indent: '  ' })\n    push('CURL *hnd = curl_easy_init();')\n    blank()\n    push(`curl_easy_setopt(hnd, CURLOPT_CUSTOMREQUEST, \"${method.toUpperCase()}\");`)\n    push(`curl_easy_setopt(hnd, CURLOPT_URL, \"${fullUrl}\");`)\n    // Add headers, including the cookies\n    const headers = Object.keys(headersObj)\n    // construct headers\n    if (headers.length) {\n      blank()\n      push('struct curl_slist *headers = NULL;')\n      headers.forEach((header) => {\n        // See https://curl.se/libcurl/c/httpcustomheader.html for syntax\n        if (headersObj[header]) {\n          push(\n            `headers = curl_slist_append(headers, \"${header}: ${escapeForDoubleQuotes(headersObj[header] as string)}\");`,\n          )\n        } else {\n          push(`headers = curl_slist_append(headers, \"${header};\");`)\n        }\n      })\n      push('curl_easy_setopt(hnd, CURLOPT_HTTPHEADER, headers);')\n    }\n    // construct cookies\n    if (allHeaders.cookie) {\n      blank()\n      push(`curl_easy_setopt(hnd, CURLOPT_COOKIE, \"${allHeaders.cookie}\");`)\n    }\n    if (postData !== null && postData !== void 0) {\n      blank()\n      if (postData.text) {\n        push(`curl_easy_setopt(hnd, CURLOPT_POSTFIELDS, ${JSON.stringify(postData.text)});`)\n      } else if (postData.mimeType === 'application/x-www-form-urlencoded' && postData.params) {\n        push(`curl_easy_setopt(hnd, CURLOPT_POSTFIELDS, \"${createSearchParams(postData.params as never).toString()}\");`)\n      } else if (postData.mimeType === 'multipart/form-data' && postData.params) {\n        push('curl_mime *mime = curl_mime_init(hnd);')\n        postData.params.forEach((param) => {\n          blank()\n          push('{')\n          push('curl_mimepart *part = curl_mime_addpart(mime);', 1)\n          if (param.name) {\n            push(`curl_mime_name(part, \"${param.name}\");`, 1)\n          }\n          if (param.fileName) {\n            push(`curl_mime_filedata(part, \"${param.fileName}\");`, 1)\n          } else if (param.value) {\n            push(`curl_mime_data(part, \"${escapeForDoubleQuotes(param.value)}\", CURL_ZERO_TERMINATED);`, 1)\n          }\n          push('}')\n        })\n        blank()\n        push('curl_easy_setopt(hnd, CURLOPT_MIMEPOST, mime);')\n      }\n    }\n    blank()\n    push('CURLcode ret = curl_easy_perform(hnd);')\n    return join()\n  },\n}\n"],
  "mappings": "AAAA,SAAS,mBAAmB;AAC5B,SAAS,6BAA6B;AAEtC,SAAS,0BAA0B;AAE5B,MAAM,UAAkB;AAAA,EAC7B,MAAM;AAAA,IACJ,KAAK;AAAA,IACL,OAAO;AAAA,IACP,MAAM;AAAA,IACN,aAAa;AAAA,EACf;AAAA,EACA,SAAS,CAAC,EAAE,QAAQ,SAAS,YAAY,YAAY,SAAS,MAAM;AAClE,UAAM,EAAE,MAAM,OAAO,KAAK,IAAI,IAAI,YAAY,EAAE,QAAQ,KAAK,CAAC;AAC9D,SAAK,+BAA+B;AACpC,UAAM;AACN,SAAK,iDAAiD,OAAO,YAAY,CAAC,KAAK;AAC/E,SAAK,uCAAuC,OAAO,KAAK;AAExD,UAAM,UAAU,OAAO,KAAK,UAAU;AAEtC,QAAI,QAAQ,QAAQ;AAClB,YAAM;AACN,WAAK,oCAAoC;AACzC,cAAQ,QAAQ,CAAC,WAAW;AAE1B,YAAI,WAAW,MAAM,GAAG;AACtB;AAAA,YACE,yCAAyC,MAAM,KAAK,sBAAsB,WAAW,MAAM,CAAW,CAAC;AAAA,UACzG;AAAA,QACF,OAAO;AACL,eAAK,yCAAyC,MAAM,MAAM;AAAA,QAC5D;AAAA,MACF,CAAC;AACD,WAAK,qDAAqD;AAAA,IAC5D;AAEA,QAAI,WAAW,QAAQ;AACrB,YAAM;AACN,WAAK,0CAA0C,WAAW,MAAM,KAAK;AAAA,IACvE;AACA,QAAI,aAAa,QAAQ,aAAa,QAAQ;AAC5C,YAAM;AACN,UAAI,SAAS,MAAM;AACjB,aAAK,6CAA6C,KAAK,UAAU,SAAS,IAAI,CAAC,IAAI;AAAA,MACrF,WAAW,SAAS,aAAa,uCAAuC,SAAS,QAAQ;AACvF,aAAK,8CAA8C,mBAAmB,SAAS,MAAe,EAAE,SAAS,CAAC,KAAK;AAAA,MACjH,WAAW,SAAS,aAAa,yBAAyB,SAAS,QAAQ;AACzE,aAAK,wCAAwC;AAC7C,iBAAS,OAAO,QAAQ,CAAC,UAAU;AACjC,gBAAM;AACN,eAAK,GAAG;AACR,eAAK,kDAAkD,CAAC;AACxD,cAAI,MAAM,MAAM;AACd,iBAAK,yBAAyB,MAAM,IAAI,OAAO,CAAC;AAAA,UAClD;AACA,cAAI,MAAM,UAAU;AAClB,iBAAK,6BAA6B,MAAM,QAAQ,OAAO,CAAC;AAAA,UAC1D,WAAW,MAAM,OAAO;AACtB,iBAAK,yBAAyB,sBAAsB,MAAM,KAAK,CAAC,6BAA6B,CAAC;AAAA,UAChG;AACA,eAAK,GAAG;AAAA,QACV,CAAC;AACD,cAAM;AACN,aAAK,gDAAgD;AAAA,MACvD;AAAA,IACF;AACA,UAAM;AACN,SAAK,wCAAwC;AAC7C,WAAO,KAAK;AAAA,EACd;AACF;",
  "names": []
}
