{
  "version": 3,
  "sources": ["../../../../../src/httpsnippet-lite/targets/clojure/clj_http/client.ts"],
  "sourcesContent": ["/**\n * @description\n * HTTP code snippet generator for Clojure using clj-http.\n *\n * @author\n * @tggreene\n *\n * for any questions or issues regarding the generated code snippet, please open an issue mentioning the author.\n */\n\nimport { CodeBuilder } from '@/httpsnippet-lite/helpers/code-builder'\nimport { getHeader, getHeaderName } from '@/httpsnippet-lite/helpers/headers'\nimport type { ReducedHelperObject } from '@/httpsnippet-lite/helpers/reducer'\nimport type { Client } from '@/httpsnippet-lite/targets/target'\n\nclass Keyword {\n  name: string\n  toString: () => string\n\n  constructor(name: string) {\n    this.name = ''\n    this.toString = () => `:${this.name}`\n    this.name = name\n  }\n}\nclass File {\n  path: string\n  toString: () => string\n\n  constructor(path: string) {\n    this.path = ''\n    this.toString = () => `(clojure.java.io/file \"${this.path}\")`\n    this.path = path\n  }\n}\nconst jsType = (input: unknown): string | null => {\n  if (input === undefined) {\n    return null\n  }\n  if (input === null) {\n    return 'null'\n  }\n  return input.constructor.name.toLowerCase()\n}\nconst objEmpty = (input: unknown): boolean => {\n  if (jsType(input) === 'object') {\n    return Object.keys(input as {}).length === 0\n  }\n  return false\n}\nconst filterEmpty = (input: Record<string, unknown>) => {\n  Object.keys(input)\n    .filter((x) => objEmpty(input[x]))\n    .forEach((x) => {\n      delete input[x]\n    })\n  return input\n}\nconst padBlock = (padSize: number, input: string): string => {\n  const padding = ' '.repeat(padSize)\n  return input.replace(/\\n/g, `\\n${padding}`)\n}\nconst jsToEdn = (js: any) => {\n  switch (jsType(js)) {\n    case 'string':\n      return `\"${js.replace(/\"/g, '\\\\\"')}\"`\n    case 'file':\n      return js.toString()\n    case 'keyword':\n      return js.toString()\n    case 'null':\n      return 'nil'\n    case 'regexp':\n      return `#\"${js.source}\"`\n    case 'object': {\n      // simple vertical format\n      const obj = Object.keys(js)\n        .reduce((accumulator, key) => {\n          const val = padBlock(key.length + 2, jsToEdn(js[key]))\n          return `${accumulator}:${key} ${val}\\n `\n        }, '')\n        .trim()\n      return `{${padBlock(1, obj)}}`\n    }\n    case 'array': {\n      // simple horizontal format\n      const arr = js.reduce((accumulator: string, value: any) => `${accumulator} ${jsToEdn(value)}`, '').trim()\n      return `[${padBlock(1, arr)}]`\n    }\n    default: // 'number' 'boolean'\n      return js.toString()\n  }\n}\nexport const clj_http: Client = {\n  info: {\n    key: 'clj_http',\n    title: 'clj-http',\n    link: 'https://github.com/dakrone/clj-http',\n    description: 'An idiomatic clojure http client wrapping the apache client.',\n  },\n  convert: ({ queryObj, method, postData, url, allHeaders }, options) => {\n    const { push, join } = new CodeBuilder({\n      indent: options === null || options === void 0 ? void 0 : options.indent,\n    })\n    const methods = ['get', 'post', 'put', 'delete', 'patch', 'head', 'options']\n    method = method.toLowerCase()\n    if (!methods.includes(method)) {\n      push('Method not supported')\n      return join()\n    }\n    const params: {\n      'headers': ReducedHelperObject\n      'query-params': ReducedHelperObject\n      [key: string]: unknown\n    } = {\n      'headers': allHeaders,\n      'query-params': queryObj,\n    }\n\n    // Remove query string from URL if queryObj has parameters\n    if (queryObj && Object.keys(queryObj).length > 0) {\n      url = url.split('?')[0]!\n    }\n\n    switch (postData === null || postData === void 0 ? void 0 : postData.mimeType) {\n      case 'application/json':\n        {\n          params['content-type'] = new Keyword('json')\n          params['form-params'] = postData!.jsonObj\n          const header = getHeaderName(params.headers, 'content-type')\n          if (header) {\n            delete params.headers[header]\n          }\n        }\n        break\n      case 'application/x-www-form-urlencoded':\n        {\n          params['form-params'] = postData!.paramsObj\n          const header = getHeaderName(params.headers, 'content-type')\n          if (header) {\n            delete params.headers[header]\n          }\n        }\n        break\n      case 'text/plain':\n        {\n          params.body = postData!.text\n          const header = getHeaderName(params.headers, 'content-type')\n          if (header) {\n            delete params.headers[header]\n          }\n        }\n        break\n      case 'multipart/form-data': {\n        if (postData?.params) {\n          params.multipart = postData.params.map((param) => {\n            if (param.fileName && !param.value) {\n              return {\n                name: param.name,\n                content: new File(param.fileName),\n              }\n            }\n            return {\n              name: param.name,\n              content: param.value,\n            }\n          })\n          const header = getHeaderName(params.headers as Record<string, unknown>, 'content-type')\n          if (header) {\n            delete params.headers[header]\n          }\n        }\n        break\n      }\n    }\n    switch (getHeader(params.headers as Record<string, unknown>, 'accept')) {\n      case 'application/json':\n        {\n          params.accept = new Keyword('json')\n          const header = getHeaderName(params.headers as Record<string, unknown>, 'accept')\n          if (header) {\n            delete params.headers[header]\n          }\n        }\n        break\n    }\n    push(\"(require '[clj-http.client :as client])\\n\")\n    if (objEmpty(filterEmpty(params))) {\n      push(`(client/${method} \"${url}\")`)\n    } else {\n      const padding = 11 + method.length + url.length\n      const formattedParams = padBlock(padding, jsToEdn(filterEmpty(params)))\n      push(`(client/${method} \"${url}\" ${formattedParams})`)\n    }\n    return join()\n  },\n}\n"],
  "mappings": "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",
  "names": []
}
