{
  "version": 3,
  "sources": ["../../../../../src/httpsnippet-lite/targets/r/httr/client.ts"],
  "sourcesContent": ["/**\n * @description\n * HTTP code snippet generator for R using httr\n *\n * @author\n * @gabrielakoreeda\n *\n * for any questions or issues regarding the generated code snippet, please open an issue mentioning the author.\n */\n\nimport { CodeBuilder } from '@/httpsnippet-lite/helpers/code-builder'\nimport { escapeForDoubleQuotes, escapeForSingleQuotes } from '@/httpsnippet-lite/helpers/escape'\nimport { getHeader } from '@/httpsnippet-lite/helpers/headers'\nimport type { Client } from '@/httpsnippet-lite/targets/target'\n\nexport const httr: Client = {\n  info: {\n    key: 'httr',\n    title: 'httr',\n    link: 'https://cran.r-project.org/web/packages/httr/vignettes/quickstart.html',\n    description: 'httr: Tools for Working with URLs and HTTP',\n  },\n  convert: ({ url, queryObj, queryString, postData, allHeaders, method }, options = {}) => {\n    let _a, _b\n    // Start snippet\n    const { push, blank, join } = new CodeBuilder({\n      indent: (_a = options.indent) !== null && _a !== void 0 ? _a : '  ',\n    })\n    // Import httr\n    push('library(httr)')\n    blank()\n    // Set URL\n    push(`url <- \"${url}\"`)\n    blank()\n    // Construct query string\n    const qs = queryObj\n    delete queryObj.key\n    const entries = Object.entries(qs)\n    const entriesCount = entries.length\n    if (entriesCount === 1) {\n      const entry = entries[0]!\n      push(`queryString <- list(${entry[0]} = \"${entry[1]}\")`)\n      blank()\n    } else if (entriesCount > 1) {\n      push('queryString <- list(')\n      entries.forEach(([key, value], i) => {\n        const isLastItem = i !== entriesCount - 1\n        const maybeComma = isLastItem ? ',' : ''\n        push(`${key} = \"${value}\"${maybeComma}`, 1)\n      })\n      push(')')\n      blank()\n    }\n    // Construct payload\n    const payload = JSON.stringify(postData === null || postData === void 0 ? void 0 : postData.text)\n    if (payload) {\n      push(`payload <- ${payload}`)\n      blank()\n    }\n    // Define encode\n    if (postData && (postData.text || postData.jsonObj || postData.params)) {\n      switch (postData.mimeType) {\n        case 'application/x-www-form-urlencoded':\n          push('encode <- \"form\"')\n          blank()\n          break\n        case 'application/json':\n          push('encode <- \"json\"')\n          blank()\n          break\n        case 'multipart/form-data':\n          push('encode <- \"multipart\"')\n          blank()\n          break\n        default:\n          push('encode <- \"raw\"')\n          blank()\n          break\n      }\n    }\n    // Construct headers\n    const cookieHeader = getHeader(allHeaders, 'cookie')\n    const acceptHeader = getHeader(allHeaders, 'accept')\n    const setCookies = cookieHeader\n      ? `set_cookies(\\`${String(cookieHeader).replace(/;/g, '\", `').replace(/` /g, '`').replace(/[=]/g, '` = \"')}\")`\n      : undefined\n    const setAccept = acceptHeader ? `accept(\"${escapeForDoubleQuotes(acceptHeader as string)}\")` : undefined\n    const setContentType = `content_type(\"${escapeForDoubleQuotes((_b = postData === null || postData === void 0 ? void 0 : postData.mimeType) !== null && _b !== void 0 ? _b : 'application/octet-stream')}\")`\n    const otherHeaders = Object.entries(allHeaders)\n      // These headers are all handled separately:\n      .filter(([key]) => !['cookie', 'accept', 'content-type'].includes(key.toLowerCase()))\n      .map(([key, value]) => `'${key}' = '${escapeForSingleQuotes(value as string)}'`)\n      .join(', ')\n    const setHeaders = otherHeaders ? `add_headers(${otherHeaders})` : undefined\n    // Construct request\n    let request = `response <- VERB(\"${method}\", url`\n    if (payload) {\n      request += ', body = payload'\n    }\n    if (queryString.length) {\n      request += ', query = queryString'\n    }\n    const headerAdditions = [setHeaders, setContentType, setAccept, setCookies].filter((x) => !!x).join(', ')\n    if (headerAdditions) {\n      request += `, ${headerAdditions}`\n    }\n    if (postData && (postData.text || postData.jsonObj || postData.params)) {\n      request += ', encode = encode'\n    }\n    request += ')'\n    push(request)\n    blank()\n    // Print response\n    push('content(response, \"text\")')\n    return join()\n  },\n}\n"],
  "mappings": "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",
  "names": []
}
