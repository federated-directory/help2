{
  "version": 3,
  "sources": ["../../../../src/plugins/shell/curl/curl.ts"],
  "sourcesContent": ["import type { Plugin } from '@scalar/types/snippetz'\n\nimport { escapeSingleQuotes } from '@/libs/shell'\n\n/**\n * shell/curl\n */\nexport const shellCurl: Plugin = {\n  target: 'shell',\n  client: 'curl',\n  title: 'Curl',\n  generate(request, configuration) {\n    // Defaults\n    const normalizedRequest = {\n      method: 'GET',\n      ...request,\n    }\n\n    // Normalization\n    normalizedRequest.method = normalizedRequest.method.toUpperCase()\n\n    // Build curl command parts\n    const parts: string[] = ['curl']\n\n    // URL (quote if has query parameters or special characters)\n    const queryString = normalizedRequest.queryString?.length\n      ? '?' +\n        normalizedRequest.queryString\n          .map((param) => {\n            // Ensure both name and value are fully URI encoded\n            const encodedName = encodeURIComponent(param.name)\n            const encodedValue = encodeURIComponent(param.value)\n            return `${encodedName}=${encodedValue}`\n          })\n          .join('&')\n      : ''\n    const url = `${normalizedRequest.url}${queryString}`\n    const hasSpecialChars = /[\\s<>[\\]{}|\\\\^%$]/.test(url)\n    const urlPart = queryString || hasSpecialChars ? `'${url}'` : url\n    parts[0] = `curl ${urlPart}`\n\n    // Method\n    if (normalizedRequest.method !== 'GET') {\n      parts.push(`--request ${normalizedRequest.method}`)\n    }\n\n    // Basic Auth\n    if (configuration?.auth?.username && configuration?.auth?.password) {\n      const authValue = escapeSingleQuotes(`${configuration.auth.username}:${configuration.auth.password}`)\n      parts.push(`--user '${authValue}'`)\n    }\n\n    // Headers\n    if (normalizedRequest.headers?.length) {\n      normalizedRequest.headers.forEach((header) => {\n        const headerValue = escapeSingleQuotes(`${header.name}: ${header.value}`)\n        parts.push(`--header '${headerValue}'`)\n      })\n\n      // Add compressed flag if Accept-Encoding header includes compression\n      const acceptEncoding = normalizedRequest.headers.find((header) => header.name.toLowerCase() === 'accept-encoding')\n      if (acceptEncoding && /gzip|deflate/.test(acceptEncoding.value)) {\n        parts.push('--compressed')\n      }\n    }\n\n    // Cookies\n    if (normalizedRequest.cookies?.length) {\n      const cookieString = normalizedRequest.cookies\n        .map((cookie) => {\n          // Encode both cookie name and value to handle special characters\n          const encodedName = encodeURIComponent(cookie.name)\n          const encodedValue = encodeURIComponent(cookie.value)\n          return `${encodedName}=${encodedValue}`\n        })\n        .join('; ')\n      const escapedCookieString = escapeSingleQuotes(cookieString)\n      parts.push(`--cookie '${escapedCookieString}'`)\n    }\n\n    // Body\n    if (normalizedRequest.postData) {\n      if (normalizedRequest.postData.mimeType === 'application/json') {\n        // Pretty print JSON data\n        if (normalizedRequest.postData.text) {\n          try {\n            const jsonData = JSON.parse(normalizedRequest.postData.text)\n            const prettyJson = JSON.stringify(jsonData, null, 2)\n            const escapedJson = escapeSingleQuotes(prettyJson)\n            parts.push(`--data '${escapedJson}'`)\n          } catch {\n            // If JSON parsing fails, use the original text\n            const escapedText = escapeSingleQuotes(normalizedRequest.postData.text ?? '')\n            parts.push(`--data '${escapedText}'`)\n          }\n        }\n      } else if (normalizedRequest.postData.mimeType === 'application/octet-stream') {\n        const escapedText = escapeSingleQuotes(normalizedRequest.postData.text ?? '')\n        parts.push(`--data-binary '${escapedText}'`)\n      } else if (\n        normalizedRequest.postData.mimeType === 'application/x-www-form-urlencoded' &&\n        normalizedRequest.postData.params\n      ) {\n        // Handle URL-encoded form data\n        normalizedRequest.postData.params.forEach((param) => {\n          const escapedValue = escapeSingleQuotes(param.value ?? '')\n          const encodedName = encodeURIComponent(param.name)\n          const escapedName = escapeSingleQuotes(encodedName)\n          parts.push(`--data-urlencode '${escapedName}=${escapedValue}'`)\n        })\n      } else if (normalizedRequest.postData.mimeType === 'multipart/form-data' && normalizedRequest.postData.params) {\n        // Handle multipart form data\n        normalizedRequest.postData.params.forEach((param) => {\n          const escapedName = escapeSingleQuotes(param.name)\n          if (param.fileName !== undefined) {\n            const escapedFileName = escapeSingleQuotes(param.fileName)\n            parts.push(`--form '${escapedName}=@${escapedFileName}'`)\n          } else {\n            const escapedValue = escapeSingleQuotes(param.value ?? '')\n            parts.push(`--form '${escapedName}=${escapedValue}'`)\n          }\n        })\n      } else {\n        // Try to parse and pretty print if it's JSON, otherwise use raw text\n        try {\n          const jsonData = JSON.parse(normalizedRequest.postData.text ?? '')\n          const prettyJson = JSON.stringify(jsonData, null, 2)\n          const escapedJson = escapeSingleQuotes(prettyJson)\n          parts.push(`--data '${escapedJson}'`)\n        } catch {\n          const escapedText = escapeSingleQuotes(normalizedRequest.postData.text ?? '')\n          parts.push(`--data '${escapedText}'`)\n        }\n      }\n    }\n\n    return parts.join(' \\\\\\n  ')\n  },\n}\n"],
  "mappings": "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",
  "names": []
}
