{
  "version": 3,
  "sources": ["../../../../src/plugins/node/undici/undici.ts"],
  "sourcesContent": ["import type { Plugin } from '@scalar/types/snippetz'\n\nimport { createSearchParams } from '@/libs/http'\nimport { Raw, objectToString } from '@/libs/javascript'\n\n/**\n * node/undici\n */\nexport const nodeUndici: Plugin = {\n  target: 'node',\n  client: 'undici',\n  title: 'undici',\n  generate(request) {\n    // Defaults\n    const normalizedRequest = {\n      method: 'GET',\n      ...request,\n    }\n\n    // Normalization\n    normalizedRequest.method = normalizedRequest.method.toUpperCase()\n\n    // Reset undici defaults\n    const options: Record<string, any> = {\n      method: normalizedRequest.method === 'GET' ? undefined : normalizedRequest.method,\n    }\n\n    // Query\n    const searchParams = createSearchParams(normalizedRequest.queryString)\n    const queryString = searchParams.size ? `?${searchParams.toString()}` : ''\n\n    // Headers\n    if (normalizedRequest.headers?.length) {\n      options.headers = {}\n\n      normalizedRequest.headers.forEach((header) => {\n        options.headers![header.name] = header.value\n      })\n    }\n\n    // Cookies\n    if (normalizedRequest.cookies?.length) {\n      options.headers = options.headers || {}\n\n      normalizedRequest.cookies.forEach((cookie) => {\n        options.headers!['Set-Cookie'] = options.headers!['Set-Cookie']\n          ? `${options.headers!['Set-Cookie']}; ${cookie.name}=${cookie.value}`\n          : `${cookie.name}=${cookie.value}`\n      })\n    }\n\n    // Remove undefined keys\n    Object.keys(options).forEach((key) => {\n      if (options[key] === undefined) {\n        delete options[key]\n      }\n    })\n\n    // Add body\n    if (normalizedRequest.postData) {\n      // Plain text\n      options.body = normalizedRequest.postData.text\n\n      // JSON\n      if (normalizedRequest.postData.mimeType === 'application/json') {\n        options.body = new Raw(`JSON.stringify(${objectToString(JSON.parse(options.body))})`)\n      }\n    }\n\n    // Transform to JSON\n    const jsonOptions = Object.keys(options).length ? `, ${objectToString(options)}` : ''\n\n    // Code Template\n    return `import { request } from 'undici'\n\nconst { statusCode, body } = await request('${normalizedRequest.url}${queryString}'${jsonOptions})`\n  },\n}\n"],
  "mappings": "AAEA,SAAS,0BAA0B;AACnC,SAAS,KAAK,sBAAsB;AAK7B,MAAM,aAAqB;AAAA,EAChC,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,SAAS,SAAS;AAEhB,UAAM,oBAAoB;AAAA,MACxB,QAAQ;AAAA,MACR,GAAG;AAAA,IACL;AAGA,sBAAkB,SAAS,kBAAkB,OAAO,YAAY;AAGhE,UAAM,UAA+B;AAAA,MACnC,QAAQ,kBAAkB,WAAW,QAAQ,SAAY,kBAAkB;AAAA,IAC7E;AAGA,UAAM,eAAe,mBAAmB,kBAAkB,WAAW;AACrE,UAAM,cAAc,aAAa,OAAO,IAAI,aAAa,SAAS,CAAC,KAAK;AAGxE,QAAI,kBAAkB,SAAS,QAAQ;AACrC,cAAQ,UAAU,CAAC;AAEnB,wBAAkB,QAAQ,QAAQ,CAAC,WAAW;AAC5C,gBAAQ,QAAS,OAAO,IAAI,IAAI,OAAO;AAAA,MACzC,CAAC;AAAA,IACH;AAGA,QAAI,kBAAkB,SAAS,QAAQ;AACrC,cAAQ,UAAU,QAAQ,WAAW,CAAC;AAEtC,wBAAkB,QAAQ,QAAQ,CAAC,WAAW;AAC5C,gBAAQ,QAAS,YAAY,IAAI,QAAQ,QAAS,YAAY,IAC1D,GAAG,QAAQ,QAAS,YAAY,CAAC,KAAK,OAAO,IAAI,IAAI,OAAO,KAAK,KACjE,GAAG,OAAO,IAAI,IAAI,OAAO,KAAK;AAAA,MACpC,CAAC;AAAA,IACH;AAGA,WAAO,KAAK,OAAO,EAAE,QAAQ,CAAC,QAAQ;AACpC,UAAI,QAAQ,GAAG,MAAM,QAAW;AAC9B,eAAO,QAAQ,GAAG;AAAA,MACpB;AAAA,IACF,CAAC;AAGD,QAAI,kBAAkB,UAAU;AAE9B,cAAQ,OAAO,kBAAkB,SAAS;AAG1C,UAAI,kBAAkB,SAAS,aAAa,oBAAoB;AAC9D,gBAAQ,OAAO,IAAI,IAAI,kBAAkB,eAAe,KAAK,MAAM,QAAQ,IAAI,CAAC,CAAC,GAAG;AAAA,MACtF;AAAA,IACF;AAGA,UAAM,cAAc,OAAO,KAAK,OAAO,EAAE,SAAS,KAAK,eAAe,OAAO,CAAC,KAAK;AAGnF,WAAO;AAAA;AAAA,8CAEmC,kBAAkB,GAAG,GAAG,WAAW,IAAI,WAAW;AAAA,EAC9F;AACF;",
  "names": []
}
