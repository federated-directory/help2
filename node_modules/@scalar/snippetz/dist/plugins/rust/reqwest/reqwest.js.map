{
  "version": 3,
  "sources": ["../../../../src/plugins/rust/reqwest/reqwest.ts"],
  "sourcesContent": ["import type { Plugin } from '@scalar/types/snippetz'\n\nimport { buildQueryString, buildUrl, normalizeRequest, processHeaders } from '@/libs/http'\nimport { createChain, formatJson, indent, wrapInDoubleQuotes } from '@/libs/rust'\n\n/**\n * rust/reqwest plugin for generating Rust reqwest HTTP client code\n */\nexport const rustReqwest: Plugin = {\n  target: 'rust',\n  client: 'reqwest',\n  title: 'reqwest',\n  generate(request, options?: { auth?: { username: string; password: string } }) {\n    if (!request) {\n      return ''\n    }\n\n    // Normalization\n    const normalizedRequest = normalizeRequest(request)\n\n    // Query string\n    const queryString = buildQueryString(normalizedRequest.queryString)\n    const url = buildUrl(normalizedRequest.url || '', queryString)\n\n    // Headers and cookies\n    const headers = processHeaders(normalizedRequest)\n\n    // Chained calls\n    const chainedCalls: string[] = []\n\n    // Auth\n    const authCall = createAuthCall(options?.auth)\n    if (authCall) {\n      chainedCalls.push(authCall)\n    }\n\n    // Headers\n    chainedCalls.push(...createHeaderCalls(headers))\n\n    // Body\n    const bodyCall = createBodyCall(normalizedRequest.postData)\n    if (bodyCall) {\n      chainedCalls.push(bodyCall)\n    }\n\n    // Code\n    return buildRustCode(url, normalizedRequest.method, chainedCalls)\n  },\n}\n\n/**\n * Helper function to create multipart form parts with proper indentation\n */\nconst createMultipartPart = (param: { name: string; value?: string; fileName?: string }): string => {\n  if (param.fileName) {\n    return [\n      indent(2, `let part = reqwest::multipart::Part::text(${wrapInDoubleQuotes(param.value || '')})`),\n      indent(3, `.file_name(${wrapInDoubleQuotes(param.fileName)});`),\n      indent(2, `form = form.part(${wrapInDoubleQuotes(param.name)}, part);`),\n    ].join('\\n')\n  }\n\n  return indent(2, `form = form.text(${wrapInDoubleQuotes(param.name)}, ${wrapInDoubleQuotes(param.value || '')});`)\n}\n\n/**\n * Creates authentication chained call if credentials are provided\n */\nconst createAuthCall = (auth?: { username: string; password: string }): string | null => {\n  if (!auth?.username || !auth?.password) {\n    return null\n  }\n\n  return createChain('basic_auth', wrapInDoubleQuotes(auth.username), wrapInDoubleQuotes(auth.password))\n}\n\n/**\n * Creates header chained calls from headers object\n */\nconst createHeaderCalls = (headers: Record<string, string>): string[] => {\n  return Object.entries(headers).map(([key, value]) =>\n    createChain('header', wrapInDoubleQuotes(key), wrapInDoubleQuotes(value)),\n  )\n}\n\n/**\n * Creates body chained call based on content type\n */\nconst createBodyCall = (postData: any): string | null => {\n  if (!postData) {\n    return null\n  }\n\n  const { mimeType, text, params } = postData\n\n  switch (mimeType) {\n    case 'application/json': {\n      const formattedJson = formatJson(text)\n      return createChain('json', `&serde_json::json!(${formattedJson})`)\n    }\n\n    case 'application/x-www-form-urlencoded': {\n      const formData =\n        params\n          ?.map((param: any) => `(${wrapInDoubleQuotes(param.name)}, ${wrapInDoubleQuotes(param.value || '')})`)\n          .join(', ') || ''\n      return createChain('form', `&[${formData}]`)\n    }\n\n    case 'multipart/form-data': {\n      const formParts = params?.map(createMultipartPart).join('\\n') || ''\n      const multipartBlock = [\n        '.multipart({',\n        indent(2, 'let mut form = reqwest::multipart::Form::new();'),\n        formParts,\n        indent(3, 'form'),\n        indent(2, '})'),\n      ].join('\\n')\n      return indent(1, multipartBlock)\n    }\n\n    default:\n      return createChain('body', wrapInDoubleQuotes(text || ''))\n  }\n}\n\n/**\n * Builds the complete Rust code by assembling all code\n */\nconst buildRustCode = (url: string, method: string, chainedCalls: string[]): string => {\n  const code = ['let client = reqwest::Client::new();', '']\n\n  // Add chained calls with proper formatting\n  if (chainedCalls.length > 0) {\n    code.push('let request = client')\n    code.push(indent(1, `.${method.toLowerCase()}(${wrapInDoubleQuotes(url)})`))\n\n    // Add a newline before the first chained call\n    code.push(...chainedCalls)\n  } else {\n    code.push(`let request = client.${method.toLowerCase()}(${wrapInDoubleQuotes(url)})`)\n  }\n\n  // Add semicolon to the last chained call\n  const lastPart = code[code.length - 1]\n  code[code.length - 1] = lastPart + ';'\n\n  // Add response handling\n  code.push('')\n  code.push('let response = request.send().await?;')\n\n  return code.join('\\n')\n}\n"],
  "mappings": "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",
  "names": []
}
