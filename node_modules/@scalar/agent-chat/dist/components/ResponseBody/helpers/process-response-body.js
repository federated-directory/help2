import m from "whatwg-mimetype";
const a = (e) => {
  try {
    return decodeURIComponent(e);
  } catch {
    return e;
  }
};
function f(e) {
  let t = "";
  if (e) {
    const n = e.match(/filename\*=UTF-8''([^;]+)/)?.[1] ?? e.match(/filename\s*=\s*"?([^";]+)"?/)?.[1];
    n && (t = a(n.trim()));
  }
  return t;
}
const l = (e) => e instanceof Blob, p = (e) => e ? Object.keys(e).map((t) => ({
  name: t,
  value: e[t] ?? ""
})) : [];
function y({ data: e, headers: t }) {
  const n = p(t), c = n.find((r) => r.name.toLowerCase() === "content-type"), o = c?.value ? new m(c.value) : void 0, i = f(
    n.find((r) => r.name.toLowerCase() === "content-disposition")?.value ?? ""
  ), s = l(e) ? URL.createObjectURL(e) : typeof e == "string" ? URL.createObjectURL(new Blob([e], { type: o ? o.toString() : void 0 })) : e instanceof Object && Object.keys(e).length ? URL.createObjectURL(
    new Blob([JSON.stringify(e)], {
      type: o ? o.toString() : void 0
    })
  ) : "";
  return { mimeType: o, attachmentFilename: i, dataUrl: s };
}
export {
  y as processResponseBody
};
