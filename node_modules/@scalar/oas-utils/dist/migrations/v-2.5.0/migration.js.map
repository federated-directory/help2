{
  "version": 3,
  "sources": ["../../../src/migrations/v-2.5.0/migration.ts"],
  "sourcesContent": ["import type { v_2_4_0 } from '@/migrations/v-2.4.0/types.generated'\n\nimport type { v_2_5_0 } from './types.generated'\n\n/** V-2.4.0 to V-2.5.0 migration */\nexport const migrate_v_2_5_0 = (data: v_2_4_0.DataRecord): v_2_5_0['DataRecord'] => {\n  console.info('Performing data migration v-2.4.0 to v-2.5.0')\n\n  const cookies = Object.entries(data.cookies || {}).reduce<Record<string, v_2_5_0['Cookie']>>((acc, [key, cookie]) => {\n    acc[key] = {\n      ...cookie,\n      uid: cookie.uid as v_2_5_0['Cookie']['uid'],\n    } satisfies v_2_5_0['Cookie']\n    return acc\n  }, {})\n\n  const collections = Object.entries(data.collections || {}).reduce<Record<string, v_2_5_0['Collection']>>(\n    (acc, [key, collection]) => {\n      acc[key] = {\n        ...collection,\n        info: collection.info ?? {\n          title: 'API',\n          version: '1.0',\n        },\n        uid: collection.uid as v_2_5_0['Collection']['uid'],\n        selectedSecuritySchemeUids:\n          collection.selectedSecuritySchemeUids as v_2_5_0['Collection']['selectedSecuritySchemeUids'],\n        servers: collection.servers.map((uid) => uid as v_2_5_0['Server']['uid']),\n        tags: collection.tags.map((uid) => uid as v_2_5_0['Tag']['uid']),\n        requests: collection.requests.map((uid) => uid as v_2_5_0['Request']['uid']),\n        children: collection.children.map((uid) => uid as v_2_5_0['Request']['uid'] | v_2_5_0['Tag']['uid']),\n        selectedServerUid: collection.selectedServerUid as v_2_5_0['Server']['uid'],\n        useCollectionSecurity: false,\n      } satisfies v_2_5_0['Collection']\n      return acc\n    },\n    {},\n  )\n\n  const environments = Object.entries(data.environments || {}).reduce<Record<string, v_2_5_0['Environment']>>(\n    (acc, [key, environment]) => {\n      acc[key] = {\n        ...environment,\n        uid: environment.uid as v_2_5_0['Environment']['uid'],\n      } satisfies v_2_5_0['Environment']\n      return acc\n    },\n    {},\n  )\n\n  const requests = Object.entries(data.requests || {}).reduce<Record<string, v_2_5_0['Request']>>(\n    (acc, [key, request]) => {\n      // Skip 'connect' operations as they are not supported in v-2.5.0\n      if (request.method === 'connect') {\n        return acc\n      }\n\n      acc[key] = {\n        ...request,\n        uid: request.uid as v_2_5_0['Request']['uid'],\n        servers: request.servers as v_2_5_0['Request']['servers'],\n        selectedServerUid: request.selectedServerUid as v_2_5_0['Request']['selectedServerUid'],\n        examples: request.examples as v_2_5_0['Request']['examples'],\n        selectedSecuritySchemeUids:\n          request.selectedSecuritySchemeUids as v_2_5_0['Request']['selectedSecuritySchemeUids'],\n        method: request.method as v_2_5_0['Request']['method'],\n      } satisfies v_2_5_0['Request']\n      return acc\n    },\n    {},\n  )\n\n  const requestExamples = Object.entries(data.requestExamples || {}).reduce<Record<string, v_2_5_0['RequestExample']>>(\n    (acc, [key, example]) => {\n      const headers = example.parameters.headers\n\n      // Check if \"Accept\" header exists\n      const hasAcceptHeader = headers.some((header) => header.key.toLowerCase() === 'accept')\n\n      if (!hasAcceptHeader) {\n        // Add \"Accept\" header as the first entry\n        headers.unshift({ key: 'Accept', value: '*/*', enabled: true })\n      }\n\n      // Update the example with potentially modified headers\n      acc[key] = {\n        ...example,\n        uid: example.uid as v_2_5_0['RequestExample']['uid'],\n        requestUid: example.requestUid as v_2_5_0['RequestExample']['requestUid'],\n        parameters: {\n          ...example.parameters,\n          headers,\n        },\n      }\n      return acc\n    },\n    {},\n  )\n\n  const securitySchemes = Object.entries(data.securitySchemes || {}).reduce<Record<string, v_2_5_0['SecurityScheme']>>(\n    (acc, [key, securityScheme]) => {\n      acc[key] = {\n        ...securityScheme,\n        uid: securityScheme.uid as v_2_5_0['SecurityScheme']['uid'],\n      } satisfies v_2_5_0['SecurityScheme']\n      return acc\n    },\n    {},\n  )\n\n  const servers = Object.entries(data.servers || {}).reduce<Record<string, v_2_5_0['Server']>>((acc, [key, server]) => {\n    acc[key] = {\n      ...server,\n      uid: server.uid as v_2_5_0['Server']['uid'],\n      variables: Object.entries(server.variables || {}).reduce<\n        Record<\n          string,\n          {\n            enum?: [string, ...string[]]\n            default: string\n            description?: string\n          }\n        >\n      >((variablesAcc, [variableKey, variable]) => {\n        variablesAcc[variableKey] = {\n          default: variable.default ?? '',\n          description: variable.description ?? '',\n          ...(variable.enum?.length && { enum: variable.enum as [string, ...string[]] }),\n        }\n        return variablesAcc\n      }, {}),\n    }\n    return acc\n  }, {})\n\n  const tags = Object.entries(data.tags || {}).reduce<Record<string, v_2_5_0['Tag']>>((acc, [key, tag]) => {\n    acc[key] = {\n      ...tag,\n      uid: tag.uid as v_2_5_0['Tag']['uid'],\n      children: tag.children as v_2_5_0['Tag']['children'],\n    } satisfies v_2_5_0['Tag']\n    return acc\n  }, {})\n\n  const workspaces = Object.entries(data.workspaces || {}).reduce<Record<string, v_2_5_0['Workspace']>>(\n    (acc, [key, workspace]) => {\n      acc[key] = {\n        ...workspace,\n        uid: workspace.uid as v_2_5_0['Workspace']['uid'],\n        collections: workspace.collections.map((uid) => uid as v_2_5_0['Collection']['uid']),\n        cookies: workspace.cookies.map((uid) => uid as v_2_5_0['Cookie']['uid']),\n        selectedHttpClient: {\n          targetKey: 'shell',\n          clientKey: 'curl',\n        },\n      }\n      return acc\n    },\n    {},\n  )\n\n  return {\n    ...data,\n    collections,\n    cookies,\n    environments,\n    requests,\n    requestExamples,\n    securitySchemes,\n    servers,\n    tags,\n    workspaces,\n  } satisfies v_2_5_0['DataRecord']\n}\n"],
  "mappings": "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",
  "names": []
}
