{
  "version": 3,
  "sources": ["../../../src/migrations/v-2.3.0/migration.ts"],
  "sourcesContent": ["import type { v_2_2_0 } from '@/migrations/v-2.2.0/types.generated'\n\nimport type { v_2_3_0 } from './types.generated'\n\n/** V-2.2.0 to V-2.3.0 migration */\nexport const migrate_v_2_3_0 = (data: v_2_2_0.DataRecord): v_2_3_0.DataRecord => {\n  console.info('Performing data migration v-2.2.0 to v-2.3.0')\n\n  const environments = data.environments\n\n  const workspaces = Object.values(data.workspaces).reduce<v_2_3_0.DataRecord['workspaces']>((prev, w) => {\n    const workspaceEnvironments: Record<string, any> = {}\n\n    Object.entries(environments).forEach(([envId, envData]) => {\n      const parsedData = typeof envData.value === 'string' ? JSON.parse(envData.value) : envData.value\n      if (envId === 'default') {\n        Object.assign(workspaceEnvironments, parsedData)\n      }\n    })\n\n    prev[w.uid] = {\n      ...w,\n      environments: workspaceEnvironments,\n    }\n    return prev\n  }, {})\n\n  const collections = Object.values(data.collections).reduce<v_2_3_0.DataRecord['collections']>((prev, c) => {\n    prev[c.uid] = {\n      ...c,\n      'x-scalar-environments': c['x-scalar-environments'] || {},\n    }\n    return prev\n  }, {})\n\n  Object.values(workspaces).forEach((workspace) => {\n    Object.entries(environments).forEach(([envKey, envData]) => {\n      if (envKey !== 'default') {\n        const parsedData = typeof envData.value === 'string' ? JSON.parse(envData.value) : envData.value\n        const envName = envData.name\n        Object.values(collections).forEach((collection) => {\n          collection['x-scalar-environments'] = collection['x-scalar-environments'] || {}\n          collection['x-scalar-environments'][envName] = {\n            variables: parsedData,\n          }\n          if (workspace.activeEnvironmentId === envKey) {\n            collection['x-scalar-active-environment'] = envName ?? ''\n          }\n        })\n      }\n    })\n  })\n\n  return {\n    ...data,\n    collections,\n    workspaces,\n  } satisfies v_2_3_0.DataRecord\n}\n"],
  "mappings": "AAKO,MAAM,kBAAkB,CAAC,SAAiD;AAC/E,UAAQ,KAAK,8CAA8C;AAE3D,QAAM,eAAe,KAAK;AAE1B,QAAM,aAAa,OAAO,OAAO,KAAK,UAAU,EAAE,OAAyC,CAAC,MAAM,MAAM;AACtG,UAAM,wBAA6C,CAAC;AAEpD,WAAO,QAAQ,YAAY,EAAE,QAAQ,CAAC,CAAC,OAAO,OAAO,MAAM;AACzD,YAAM,aAAa,OAAO,QAAQ,UAAU,WAAW,KAAK,MAAM,QAAQ,KAAK,IAAI,QAAQ;AAC3F,UAAI,UAAU,WAAW;AACvB,eAAO,OAAO,uBAAuB,UAAU;AAAA,MACjD;AAAA,IACF,CAAC;AAED,SAAK,EAAE,GAAG,IAAI;AAAA,MACZ,GAAG;AAAA,MACH,cAAc;AAAA,IAChB;AACA,WAAO;AAAA,EACT,GAAG,CAAC,CAAC;AAEL,QAAM,cAAc,OAAO,OAAO,KAAK,WAAW,EAAE,OAA0C,CAAC,MAAM,MAAM;AACzG,SAAK,EAAE,GAAG,IAAI;AAAA,MACZ,GAAG;AAAA,MACH,yBAAyB,EAAE,uBAAuB,KAAK,CAAC;AAAA,IAC1D;AACA,WAAO;AAAA,EACT,GAAG,CAAC,CAAC;AAEL,SAAO,OAAO,UAAU,EAAE,QAAQ,CAAC,cAAc;AAC/C,WAAO,QAAQ,YAAY,EAAE,QAAQ,CAAC,CAAC,QAAQ,OAAO,MAAM;AAC1D,UAAI,WAAW,WAAW;AACxB,cAAM,aAAa,OAAO,QAAQ,UAAU,WAAW,KAAK,MAAM,QAAQ,KAAK,IAAI,QAAQ;AAC3F,cAAM,UAAU,QAAQ;AACxB,eAAO,OAAO,WAAW,EAAE,QAAQ,CAAC,eAAe;AACjD,qBAAW,uBAAuB,IAAI,WAAW,uBAAuB,KAAK,CAAC;AAC9E,qBAAW,uBAAuB,EAAE,OAAO,IAAI;AAAA,YAC7C,WAAW;AAAA,UACb;AACA,cAAI,UAAU,wBAAwB,QAAQ;AAC5C,uBAAW,6BAA6B,IAAI,WAAW;AAAA,UACzD;AAAA,QACF,CAAC;AAAA,MACH;AAAA,IACF,CAAC;AAAA,EACH,CAAC;AAED,SAAO;AAAA,IACL,GAAG;AAAA,IACH;AAAA,IACA;AAAA,EACF;AACF;",
  "names": []
}
