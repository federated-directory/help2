{
  "version": 3,
  "sources": ["../../../src/entities/spec/requests.ts"],
  "sourcesContent": ["import {\n  type PostResponseSchema,\n  XCodeSamplesSchema,\n  XPostResponseSchema,\n} from '@scalar/openapi-types/schemas/extensions'\nimport { oasSecurityRequirementSchema } from '@scalar/types/entities'\nimport { XScalarStability } from '@scalar/types/legacy'\nimport { type ENTITY_BRANDS, nanoidSchema } from '@scalar/types/utils'\nimport { type ZodSchema, z } from 'zod'\n\nimport { selectedSecuritySchemeUidSchema } from '@/entities/shared/utility'\n\nimport { oasParameterSchema } from './parameters'\nimport { type RequestExample, xScalarExampleSchema } from './request-examples'\nimport { oasExternalDocumentationSchema } from './spec-objects'\n\nconst requestMethods = ['delete', 'get', 'head', 'options', 'patch', 'post', 'put', 'trace'] as const\n\nexport type RequestMethod = (typeof requestMethods)[number]\n\n/** A single set of populated values for a sent request */\nexport type ResponseInstance = Omit<Response, 'headers'> & {\n  /** Store headers as an object to match what we had with axios */\n  headers: Record<string, string>\n  /** Keys of headers which set cookies */\n  cookieHeaderKeys: string[]\n  /** Time in ms the request took */\n  duration: number\n  /** The response status */\n  status: number\n  /** The response status text */\n  statusText: string\n  /** The response method */\n  method: RequestMethod\n  /** The request path */\n  path: string\n} & (\n    | {\n        /** The response data */\n        data: string | Blob\n        /** The response size in bytes */\n        size: number\n      }\n    | {\n        /** A stream reader for a streamable response body */\n        reader: ReadableStreamDefaultReader<Uint8Array>\n      }\n  )\n\n/** A single request/response set to save to the history stack */\nexport type RequestEvent = {\n  request: RequestExample\n  response: ResponseInstance\n  timestamp: number\n}\n\n// TODO: Type body definitions\ntype RequestBody = object\nconst requestBodySchema = z.any() satisfies ZodSchema<RequestBody>\n\n/** Open API Compliant Request Validator */\nconst oasRequestSchema = z.object({\n  /**\n   * A list of tags for API documentation control. Tags can be used for logical\n   * grouping of operations by resources or any other qualifier.\n   *\n   * These tags are the openapi spec tag names, not uids\n   */\n  'tags': z.string().array().optional(),\n  /** A short summary of what the operation does. */\n  'summary': z.string().optional(),\n  /** A verbose explanation of the operation behavior. CommonMark syntax MAY be used for rich text representation. */\n  'description': z.string().optional(),\n  /**\n   * Unique string used to identify the operation. The id MUST be unique among all operations described in the API.\n   * The operationId value is case-sensitive. Tools and libraries MAY use the operationId to uniquely identify an\n   * operation, therefore, it is RECOMMENDED to follow bin common programming naming conventions./\n   */\n  'operationId': z.string().optional(),\n  /**\n   * A declaration of which security mechanisms can be used across the API. The list of\n   * values includes alternative security requirement objects that can be used. Only\n   * one of the security requirement objects need to be satisfied to authorize a request.\n   * Individual operations can override this definition. To make security optional, an empty\n   * security requirement ({}) can be included in the array.\n   */\n  'security': z.array(oasSecurityRequirementSchema).optional(),\n  /**\n   * The request body applicable for this operation. The requestBody is fully supported in HTTP methods where the\n   * HTTP 1.1 specification [RFC7231] has explicitly defined semantics for request bodies. In other cases where the\n   * HTTP spec is vague (such as GET, HEAD and DELETE), requestBody is permitted but does not have well-defined\n   * semantics and SHOULD be avoided if possible.\n   */\n  'requestBody': requestBodySchema.optional(),\n  /**\n   * Request parameters\n   */\n  'parameters': oasParameterSchema.array().optional(),\n  /**\n   * External documentation object\n   */\n  'externalDocs': oasExternalDocumentationSchema.optional(),\n  'deprecated': z.boolean().optional(),\n  /** Response formats */\n  'responses': z.record(z.string(), z.any()).optional(),\n  /** Callbacks */\n  'callbacks': z.record(z.string(), z.record(z.string(), z.record(z.string(), z.any()))).optional(),\n  /** xScalar examples */\n  'x-scalar-examples': z.record(z.string(), xScalarExampleSchema).optional(),\n  /** Hide operations */\n  'x-internal': z.boolean().optional(),\n  /** Ignore operations */\n  'x-scalar-ignore': z.boolean().optional(),\n})\n\n/**\n * An OpenAPI extension to indicate the stability of the operation\n *\n * @example\n * ```yaml\n * x-scalar-stability: deprecated\n * ```\n */\nconst ScalarStabilitySchema = z.object({\n  'x-scalar-stability': z\n    .enum([XScalarStability.Deprecated, XScalarStability.Experimental, XScalarStability.Stable])\n    .optional()\n    .catch(undefined),\n})\n\n/**\n * Extended properties added to the spec definition for client usage\n *\n * WARNING: DO NOT ADD PROPERTIES THAT SHARE A NAME WITH OAS OPERATION ENTITIES\n *\n * This object is directly converted to a spec operation during saving\n */\nconst extendedRequestSchema = z.object({\n  type: z.literal('request').optional().default('request'),\n  uid: nanoidSchema.brand<ENTITY_BRANDS['OPERATION']>(),\n  /** Path Key */\n  path: z.string().optional().default(''),\n  /** Request Method */\n  method: z.enum(requestMethods).default('get'),\n  /** List of server UIDs specific to the request */\n  servers: z.string().brand<ENTITY_BRANDS['SERVER']>().array().default([]),\n  /** The currently selected server */\n  selectedServerUid: z.string().brand<ENTITY_BRANDS['SERVER']>().optional().nullable().default(null),\n  /** List of example UIDs associated with the request */\n  examples: z.string().brand<ENTITY_BRANDS['EXAMPLE']>().array().default([]),\n  /** List of security scheme UIDs associated with the request */\n  selectedSecuritySchemeUids: selectedSecuritySchemeUidSchema,\n})\n\nexport type PostResponseScript = z.infer<typeof PostResponseSchema>\nexport type PostResponseScripts = z.infer<typeof XPostResponseSchema>['x-post-response']\n\n/** Unified request schema for client usage */\nexport const requestSchema = oasRequestSchema\n  .omit({ 'x-scalar-examples': true })\n  .merge(XCodeSamplesSchema)\n  .merge(ScalarStabilitySchema)\n  .merge(extendedRequestSchema)\n  .merge(XPostResponseSchema)\n\nexport type Request = z.infer<typeof requestSchema>\nexport type RequestPayload = z.input<typeof requestSchema>\n"],
  "mappings": "AAAA;AAAA,EAEE;AAAA,EACA;AAAA,OACK;AACP,SAAS,oCAAoC;AAC7C,SAAS,wBAAwB;AACjC,SAA6B,oBAAoB;AACjD,SAAyB,SAAS;AAElC,SAAS,uCAAuC;AAEhD,SAAS,0BAA0B;AACnC,SAA8B,4BAA4B;AAC1D,SAAS,sCAAsC;AAE/C,MAAM,iBAAiB,CAAC,UAAU,OAAO,QAAQ,WAAW,SAAS,QAAQ,OAAO,OAAO;AA0C3F,MAAM,oBAAoB,EAAE,IAAI;AAGhC,MAAM,mBAAmB,EAAE,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOhC,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS;AAAA;AAAA,EAEpC,WAAW,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAE/B,eAAe,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMnC,eAAe,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQnC,YAAY,EAAE,MAAM,4BAA4B,EAAE,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAO3D,eAAe,kBAAkB,SAAS;AAAA;AAAA;AAAA;AAAA,EAI1C,cAAc,mBAAmB,MAAM,EAAE,SAAS;AAAA;AAAA;AAAA;AAAA,EAIlD,gBAAgB,+BAA+B,SAAS;AAAA,EACxD,cAAc,EAAE,QAAQ,EAAE,SAAS;AAAA;AAAA,EAEnC,aAAa,EAAE,OAAO,EAAE,OAAO,GAAG,EAAE,IAAI,CAAC,EAAE,SAAS;AAAA;AAAA,EAEpD,aAAa,EAAE,OAAO,EAAE,OAAO,GAAG,EAAE,OAAO,EAAE,OAAO,GAAG,EAAE,OAAO,EAAE,OAAO,GAAG,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,SAAS;AAAA;AAAA,EAEhG,qBAAqB,EAAE,OAAO,EAAE,OAAO,GAAG,oBAAoB,EAAE,SAAS;AAAA;AAAA,EAEzE,cAAc,EAAE,QAAQ,EAAE,SAAS;AAAA;AAAA,EAEnC,mBAAmB,EAAE,QAAQ,EAAE,SAAS;AAC1C,CAAC;AAUD,MAAM,wBAAwB,EAAE,OAAO;AAAA,EACrC,sBAAsB,EACnB,KAAK,CAAC,iBAAiB,YAAY,iBAAiB,cAAc,iBAAiB,MAAM,CAAC,EAC1F,SAAS,EACT,MAAM,MAAS;AACpB,CAAC;AASD,MAAM,wBAAwB,EAAE,OAAO;AAAA,EACrC,MAAM,EAAE,QAAQ,SAAS,EAAE,SAAS,EAAE,QAAQ,SAAS;AAAA,EACvD,KAAK,aAAa,MAAkC;AAAA;AAAA,EAEpD,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE;AAAA;AAAA,EAEtC,QAAQ,EAAE,KAAK,cAAc,EAAE,QAAQ,KAAK;AAAA;AAAA,EAE5C,SAAS,EAAE,OAAO,EAAE,MAA+B,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;AAAA;AAAA,EAEvE,mBAAmB,EAAE,OAAO,EAAE,MAA+B,EAAE,SAAS,EAAE,SAAS,EAAE,QAAQ,IAAI;AAAA;AAAA,EAEjG,UAAU,EAAE,OAAO,EAAE,MAAgC,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;AAAA;AAAA,EAEzE,4BAA4B;AAC9B,CAAC;AAMM,MAAM,gBAAgB,iBAC1B,KAAK,EAAE,qBAAqB,KAAK,CAAC,EAClC,MAAM,kBAAkB,EACxB,MAAM,qBAAqB,EAC3B,MAAM,qBAAqB,EAC3B,MAAM,mBAAmB;",
  "names": []
}
