const l = (s, f = [], a = {}) => {
  if (!s || s.length === 0)
    return [];
  const o = s.filter((e) => Object.keys(e).length > 0);
  if (o.length === 0)
    return [];
  if (f.length === 0) {
    const e = o[0], r = e ? Object.keys(e)[0] : void 0, n = Object.values(a).find((t) => t.nameKey === r);
    return n ? [n] : [];
  }
  const m = new Set(
    o.map((e) => Object.keys(e).sort().join(","))
  ), h = [];
  for (const e of f) {
    const r = Array.isArray(e) ? e : [e], n = [], t = [];
    for (const i of r) {
      const c = a[i];
      c?.nameKey && (n.push(c), t.push(c.nameKey));
    }
    if (t.length > 0) {
      const i = t.sort().join(",");
      m.has(i) && h.push(...n);
    }
  }
  return h;
};
export {
  l as filterSecurityRequirements
};
