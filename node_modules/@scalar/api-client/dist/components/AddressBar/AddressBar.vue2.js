import { defineComponent as E, useId as I, ref as s, watch as z, createElementBlock as L, openBlock as b, unref as n, createElementVNode as l, createVNode as u, normalizeStyle as U, createBlock as $, createCommentVNode as A, withCtx as M, toDisplayString as p } from "vue";
import { ScalarButton as H } from "@scalar/components";
import { REQUEST_METHODS as N } from "@scalar/helpers/http/http-info";
import { ScalarIconPlay as T } from "@scalar/icons";
import D from "../CodeInput/CodeInput.vue.js";
import O from "../HttpMethod/HttpMethod.vue.js";
import P from "./AddressBarHistory.vue.js";
import { useWorkspace as K } from "../../store/store.js";
import { useLayout as Q } from "../../hooks/useLayout.js";
import W from "../Server/ServerDropdown.vue.js";
const j = ["id"], F = { class: "address-bar-bg-states text-xxs group relative order-last flex w-full max-w-[calc(100dvw-24px)] flex-1 flex-row items-stretch rounded-lg p-0.75 lg:order-none lg:max-w-[580px] lg:min-w-[580px] xl:max-w-[720px] xl:min-w-[720px]" }, G = { class: "pointer-events-none absolute top-0 left-0 block h-full w-full overflow-hidden rounded-lg border" }, J = { class: "z-context-plus flex gap-1" }, X = { class: "scroll-timeline-x scroll-timeline-x-hidden z-context-plus relative flex w-full bg-blend-normal" }, Y = {
  "aria-hidden": "true",
  class: "inline-flex items-center gap-1"
}, Z = { class: "sr-only" }, ue = /* @__PURE__ */ E({
  __name: "AddressBar",
  props: {
    collection: {},
    operation: {},
    server: {},
    environment: {},
    envVariables: {},
    workspace: {}
  },
  emits: ["importCurl"],
  setup(e) {
    const c = I(), { requestMutators: f, events: d } = K(), { layout: m } = Q(), v = s(null), x = s(null), w = (t) => {
      e.operation.path !== t && f.edit(e.operation.uid, "path", t);
    };
    z(
      () => e.operation.path,
      (t) => {
        t && w(t);
      }
    );
    const o = s(100), g = s(0), a = s(!1), i = s();
    function k() {
      a.value ? o.value -= (o.value - 15) / 60 : o.value -= g.value / 20, o.value <= 0 && (clearInterval(i.value), i.value = void 0, o.value = 100, a.value = !1);
    }
    function B() {
      i.value || (a.value = !0, i.value = setInterval(k, 20));
    }
    function y() {
      g.value = o.value, a.value = !1;
    }
    function C() {
      clearInterval(i.value), i.value = void 0, o.value = 100, a.value = !1;
    }
    d.requestStatus.on((t) => {
      if (t === "start")
        return B();
      if (t === "stop")
        return y();
      if (t === "abort")
        return C();
    }), d.focusAddressBar.on(() => {
      m === "modal" ? x.value?.$el?.focus() : v.value?.focus();
    });
    function R(t) {
      f.edit(e.operation.uid, "method", t);
    }
    function q() {
      const { method: t } = e.operation;
      return N[t].colorVar;
    }
    function h() {
      a.value || (a.value = !0, d.executeRequest.emit({ requestUid: e.operation.uid }));
    }
    d.hotKeys.on((t) => {
      t?.focusAddressBar && v.value?.focus(), t?.executeRequest && h();
    });
    function S(t) {
      f.edit(e.operation.uid, "path", t);
    }
    return (t, r) => (b(), L("div", {
      id: n(c),
      class: "scalar-address-bar order-last flex h-(--scalar-address-bar-height) w-full [--scalar-address-bar-height:32px] lg:order-none lg:w-auto"
    }, [
      l("div", F, [
        l("div", G, [
          l("div", {
            class: "absolute top-0 left-0 z-[1002] h-full w-full",
            style: U({
              backgroundColor: `color-mix(in srgb, transparent 90%, ${q()})`,
              transform: `translate3d(-${o.value}%,0,0)`
            })
          }, null, 4)
        ]),
        l("div", J, [
          u(O, {
            isEditable: n(m) !== "modal",
            isSquare: "",
            method: e.operation.method,
            teleport: "",
            onChange: R
          }, null, 8, ["isEditable", "method"])
        ]),
        l("div", X, [
          e.collection.servers.length ? (b(), $(n(W), {
            key: 0,
            collection: e.collection,
            layout: "client",
            operation: e.operation,
            server: e.server,
            target: n(c)
          }, null, 8, ["collection", "operation", "server", "target"])) : A("", !0),
          r[1] || (r[1] = l("div", { class: "fade-left" }, null, -1)),
          u(D, {
            ref_key: "addressBarRef",
            ref: v,
            "aria-label": "Path",
            class: "min-w-fit outline-none",
            disableCloseBrackets: "",
            disabled: n(m) === "modal",
            disableEnter: "",
            disableTabIndent: "",
            emitOnBlur: !1,
            envVariables: e.envVariables,
            environment: e.environment,
            importCurl: "",
            modelValue: e.operation.path,
            placeholder: e.server?.uid && e.collection.servers.includes(e.server.uid) ? "" : "Enter a URL or cURL command",
            server: "",
            workspace: e.workspace,
            onCurl: r[0] || (r[0] = (V) => t.$emit("importCurl", V)),
            onSubmit: h,
            "onUpdate:modelValue": S
          }, null, 8, ["disabled", "envVariables", "environment", "modelValue", "placeholder", "workspace"]),
          r[2] || (r[2] = l("div", { class: "fade-right" }, null, -1))
        ]),
        u(P, {
          operation: e.operation,
          target: n(c)
        }, null, 8, ["operation", "target"]),
        u(n(H), {
          ref_key: "sendButtonRef",
          ref: x,
          class: "z-context-plus relative h-auto shrink-0 overflow-hidden py-1 pr-2.5 pl-2 font-bold",
          disabled: a.value,
          onClick: h
        }, {
          default: M(() => [
            l("span", Y, [
              u(n(T), {
                class: "relative shrink-0",
                size: "xs",
                weight: "fill"
              }),
              r[3] || (r[3] = l("span", { class: "text-xxs hidden lg:flex" }, "Send", -1))
            ]),
            l("span", Z, " Send " + p(e.operation.method) + " request to " + p(e.server?.url ?? "") + p(e.operation.path), 1)
          ]),
          _: 1
        }, 8, ["disabled"])
      ])
    ], 8, j));
  }
});
export {
  ue as default
};
