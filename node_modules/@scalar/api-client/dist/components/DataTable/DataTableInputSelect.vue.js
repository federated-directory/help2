import { defineComponent as T, computed as m, ref as x, watch as C, nextTick as E, createElementBlock as f, openBlock as o, createBlock as v, withDirectives as K, unref as a, withCtx as s, createVNode as n, createElementVNode as i, toDisplayString as y, withKeys as M, vModelText as R, createCommentVNode as _, Fragment as b, renderList as U, normalizeClass as $ } from "vue";
import { ScalarComboboxMultiselect as F, ScalarButton as D, ScalarIcon as h, ScalarDropdown as L, ScalarDropdownItem as z, ScalarDropdownDivider as W } from "@scalar/components";
const q = { class: "group-[.alert]:outline-orange group-[.error]:outline-red w-full pr-10 -outline-offset-1 has-[:focus-visible]:rounded-[4px] has-[:focus-visible]:outline" }, G = { class: "text-c-1 whitespace-nowrap" }, H = { class: "text-c-1 overflow-hidden text-ellipsis" }, J = { class: "overflow-hidden text-ellipsis" }, P = { class: "flex h-4 w-4 items-center justify-center" }, Z = /* @__PURE__ */ T({
  __name: "DataTableInputSelect",
  props: {
    modelValue: {},
    value: {},
    default: {},
    canAddCustomValue: { type: Boolean, default: !0 },
    type: {}
  },
  emits: ["update:modelValue"],
  setup(w, { emit: B }) {
    const u = w, c = B, p = m(() => u.value ?? []), d = x(!1), r = x(""), g = x(null);
    C(r, (e) => {
      c("update:modelValue", e);
    });
    const k = (e) => {
      c("update:modelValue", e), d.value = !1;
    }, j = () => {
      r.value.trim() && k(r.value);
    }, A = () => {
      r.value.trim() || c("update:modelValue", ""), d.value = !1;
    }, I = (e) => u.modelValue.toString() === e;
    C(d, (e) => {
      e && E(() => {
        g.value?.focus();
      });
    });
    const S = m(() => u.modelValue !== void 0 ? u.modelValue : u.default), V = m(() => {
      const e = new Set(u.modelValue.toString().split(", "));
      return p.value.filter((t) => e.has(t)).map((t) => ({ id: t, label: t, value: t }));
    }), N = m(
      () => p.value.map((e) => ({ id: e, label: e, value: e }))
    ), O = (e) => {
      const t = e.map((l) => l.value);
      c("update:modelValue", t.join(", "));
    };
    return (e, t) => (o(), f("div", q, [
      w.type === "array" ? (o(), v(a(F), {
        key: 0,
        modelValue: V.value,
        options: N.value,
        "onUpdate:modelValue": O
      }, {
        default: s(() => [
          n(a(D), {
            class: "custom-scroll h-full justify-start gap-1.5 px-2 py-1.5 pr-6 font-normal outline-none",
            fullWidth: "",
            variant: "ghost"
          }, {
            default: s(() => [
              i("span", G, y(V.value.length > 0 ? V.value.map((l) => l.label).join(", ") : "Select a value"), 1),
              n(a(h), {
                icon: "ChevronDown",
                size: "md",
                class: "min-w-4"
              })
            ]),
            _: 1
          })
        ]),
        _: 1
      }, 8, ["modelValue", "options"])) : d.value ? K((o(), f("input", {
        key: 1,
        ref_key: "inputRef",
        ref: g,
        "onUpdate:modelValue": t[0] || (t[0] = (l) => r.value = l),
        class: "text-c-1 w-full min-w-0 border-none px-2 py-1.5 outline-none",
        placeholder: "Value",
        type: "text",
        onBlur: A,
        onKeyup: M(j, ["enter"])
      }, null, 544)), [
        [R, r.value]
      ]) : (o(), v(a(L), {
        key: 2,
        resize: "",
        value: S.value
      }, {
        items: s(() => [
          (o(!0), f(b, null, U(p.value, (l) => (o(), v(a(z), {
            key: l,
            class: "group/item flex items-center gap-1.5 overflow-hidden text-ellipsis whitespace-nowrap",
            value: l,
            onClick: (Q) => k(l)
          }, {
            default: s(() => [
              i("div", {
                class: $([
                  "flex h-4 w-4 items-center justify-center rounded-full p-[3px]",
                  I(l) ? "bg-c-accent text-b-1" : "shadow-border text-transparent"
                ])
              }, [
                n(a(h), {
                  class: "size-2.5",
                  icon: "Checkmark",
                  thickness: "3"
                })
              ], 2),
              i("span", J, y(l), 1)
            ]),
            _: 2
          }, 1032, ["value", "onClick"]))), 128)),
          w.canAddCustomValue ? (o(), f(b, { key: 0 }, [
            p.value.length ? (o(), v(a(W), { key: 0 })) : _("", !0),
            n(a(z), {
              class: "flex items-center gap-1.5",
              onClick: t[1] || (t[1] = (l) => d.value = !0)
            }, {
              default: s(() => [
                i("div", P, [
                  n(a(h), {
                    icon: "Add",
                    size: "sm"
                  })
                ]),
                t[2] || (t[2] = i("span", null, "Add value", -1))
              ]),
              _: 1
            })
          ], 64)) : _("", !0)
        ]),
        default: s(() => [
          n(a(D), {
            class: "size-full justify-start gap-1.5 overflow-auto px-2 py-1.5 font-normal whitespace-nowrap outline-none",
            variant: "ghost"
          }, {
            default: s(() => [
              i("span", H, y(S.value || "Select a value"), 1),
              n(a(h), {
                icon: "ChevronDown",
                size: "md"
              })
            ]),
            _: 1
          })
        ]),
        _: 1
      }, 8, ["value"]))
    ]));
  }
});
export {
  Z as default
};
