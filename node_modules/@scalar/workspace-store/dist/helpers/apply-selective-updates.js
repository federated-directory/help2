import { apply, diff } from "@scalar/json-magic/diff";
import { split } from "../helpers/general.js";
const isSecretKey = (key) => key.startsWith("x-scalar-secret-");
const excludeKeys = /* @__PURE__ */ new Set(["x-scalar-navigation", "x-ext", "x-ext-urls", "$status", "x-scalar-is-dirty"]);
const filterDiff = (diff2) => {
  if (diff2.path.some((p) => excludeKeys.has(p))) {
    return false;
  }
  if (isSecretKey(diff2.path.at(-1) ?? "")) {
    return false;
  }
  return true;
};
const applySelectiveUpdates = (originalDocument, updatedDocument) => {
  const diffs = diff(originalDocument, updatedDocument);
  const [writableDiffs, excludedDiffs] = split(diffs, filterDiff);
  apply(originalDocument, writableDiffs);
  return excludedDiffs;
};
export {
  applySelectiveUpdates
};
//# sourceMappingURL=apply-selective-updates.js.map
