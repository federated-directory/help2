{
  "version": 3,
  "sources": ["../../../src/navigation/helpers/traverse-webhooks.ts"],
  "sourcesContent": ["import type { HttpMethod } from '@scalar/helpers/http/http-methods'\nimport { isHttpMethod } from '@scalar/helpers/http/is-http-method'\nimport { objectKeys } from '@scalar/helpers/object/object-keys'\n\nimport { getResolvedRef } from '@/helpers/get-resolved-ref'\nimport { isDeprecatedOperation } from '@/navigation/helpers/traverse-paths'\nimport type { TagsMap, TraverseSpecOptions } from '@/navigation/types'\nimport type { ParentTag, TraversedWebhook } from '@/schemas/navigation'\nimport type { OpenApiDocument, OperationObject, TagObject } from '@/schemas/v3.1/strict/openapi-document'\n\nimport { getTag } from './get-tag'\n\n/** Creates a traversed webhook entry from an OpenAPI webhook object.\n *\n * @param ref - JSON pointer reference to the webhook in the OpenAPI document\n * @param method - HTTP method of the webhook\n * @param name - Name of the webhook, defaults to 'Unknown'\n * @param title - Title of the webhook, defaults to 'Unknown'\n * @param entitiesMap - Map to store webhook IDs and titles for mobile header navigation\n * @param getWebhookId - Function to generate unique IDs for webhooks\n * @param tag - Optional tag object associated with the webhook\n * @returns A traversed webhook entry with ID, title, name, method and reference\n */\nconst createWebhookEntry = ({\n  ref,\n  method,\n  name,\n  title,\n  generateId,\n  parentTag,\n  webhook,\n  isDeprecated,\n  parentId,\n}: {\n  ref: string\n  method: HttpMethod\n  webhook: OperationObject\n  name: string\n  title: string\n  generateId: TraverseSpecOptions['generateId']\n  tag?: TagObject\n  parentId: string\n  parentTag?: ParentTag\n  isDeprecated?: boolean\n}): TraversedWebhook => {\n  const id = generateId({\n    type: 'webhook',\n    name,\n    method,\n    webhook: webhook,\n    parentTag,\n    parentId: parentId,\n  })\n\n  const entry = {\n    id,\n    title,\n    name,\n    ref,\n    method: method,\n    type: 'webhook',\n    isDeprecated,\n  } satisfies TraversedWebhook\n\n  return entry\n}\n\n/** Traverses the webhooks in an OpenAPI document to build an array of webhook entries.\n *\n * This function processes each webhook in the document to:\n * - Filter out internal webhooks (marked with x-internal) and webhooks to ignore (marked with x-scalar-ignore)\n * - Group webhooks by their tags\n * - Create webhook entries with unique references and IDs\n * - Store webhook IDs and titles for mobile header navigation\n *\n * @param content - The OpenAPI document to traverse\n * @param tagsMap - Map of tag names to arrays of traversed entries from operations\n * @param tagsDict - Dictionary mapping tag names to their OpenAPI tag objects\n * @param entitiesMap - Map to store webhook IDs and titles for mobile header navigation\n * @param getWebhookId - Function to generate unique IDs for webhooks\n * @returns Array of untagged webhook entries\n */\nexport const traverseWebhooks = ({\n  document,\n  tagsMap,\n  generateId,\n  untaggedWebhooksParentId,\n  documentId,\n}: {\n  /** Openapi document */\n  document: OpenApiDocument\n  /** The tag map from from traversing paths */\n  tagsMap: TagsMap\n  generateId: TraverseSpecOptions['generateId']\n  untaggedWebhooksParentId: string\n  documentId: string\n}): TraversedWebhook[] => {\n  const untagged: TraversedWebhook[] = []\n\n  // Traverse webhooks\n  Object.entries(document.webhooks ?? {}).forEach(([name, pathItemObject]) => {\n    const pathKeys = objectKeys(pathItemObject ?? {}).filter((key) => isHttpMethod(key))\n\n    pathKeys.forEach((method) => {\n      const _operation = pathItemObject?.[method]\n      const operation = getResolvedRef(_operation)\n      if (!operation) {\n        return\n      }\n\n      // Skip if the operation is internal or scalar-ignore\n      if (operation['x-internal'] || operation['x-scalar-ignore']) {\n        return\n      }\n\n      const ref = `#/webhooks/${name}/${method}`\n\n      if (operation.tags?.length) {\n        operation.tags.forEach((tagName: string) => {\n          const { tag, id: tagId } = getTag({ tagsMap, name: tagName, documentId, generateId })\n          tagsMap.get(tagName)?.entries.push(\n            createWebhookEntry({\n              ref,\n              method,\n              name,\n              title: operation.summary ?? name,\n              webhook: operation,\n              generateId: generateId,\n              parentTag: { tag, id: tagId },\n              parentId: tagId,\n              isDeprecated: isDeprecatedOperation(operation),\n            }),\n          )\n        })\n      }\n      // Add to untagged\n      else {\n        untagged.push(\n          createWebhookEntry({\n            ref,\n            method,\n            name,\n            title: operation.summary ?? name,\n            generateId,\n            isDeprecated: isDeprecatedOperation(operation),\n            webhook: operation,\n            parentId: untaggedWebhooksParentId,\n          }),\n        )\n      }\n    })\n  })\n\n  return untagged\n}\n"],
  "mappings": "AACA,SAAS,oBAAoB;AAC7B,SAAS,kBAAkB;AAE3B,SAAS,sBAAsB;AAC/B,SAAS,6BAA6B;AAKtC,SAAS,cAAc;AAavB,MAAM,qBAAqB,CAAC;AAAA,EAC1B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAWwB;AACtB,QAAM,KAAK,WAAW;AAAA,IACpB,MAAM;AAAA,IACN;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAED,QAAM,QAAQ;AAAA,IACZ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,MAAM;AAAA,IACN;AAAA,EACF;AAEA,SAAO;AACT;AAiBO,MAAM,mBAAmB,CAAC;AAAA,EAC/B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,MAQ0B;AACxB,QAAM,WAA+B,CAAC;AAGtC,SAAO,QAAQ,SAAS,YAAY,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,MAAM,cAAc,MAAM;AAC1E,UAAM,WAAW,WAAW,kBAAkB,CAAC,CAAC,EAAE,OAAO,CAAC,QAAQ,aAAa,GAAG,CAAC;AAEnF,aAAS,QAAQ,CAAC,WAAW;AAC3B,YAAM,aAAa,iBAAiB,MAAM;AAC1C,YAAM,YAAY,eAAe,UAAU;AAC3C,UAAI,CAAC,WAAW;AACd;AAAA,MACF;AAGA,UAAI,UAAU,YAAY,KAAK,UAAU,iBAAiB,GAAG;AAC3D;AAAA,MACF;AAEA,YAAM,MAAM,cAAc,IAAI,IAAI,MAAM;AAExC,UAAI,UAAU,MAAM,QAAQ;AAC1B,kBAAU,KAAK,QAAQ,CAAC,YAAoB;AAC1C,gBAAM,EAAE,KAAK,IAAI,MAAM,IAAI,OAAO,EAAE,SAAS,MAAM,SAAS,YAAY,WAAW,CAAC;AACpF,kBAAQ,IAAI,OAAO,GAAG,QAAQ;AAAA,YAC5B,mBAAmB;AAAA,cACjB;AAAA,cACA;AAAA,cACA;AAAA,cACA,OAAO,UAAU,WAAW;AAAA,cAC5B,SAAS;AAAA,cACT;AAAA,cACA,WAAW,EAAE,KAAK,IAAI,MAAM;AAAA,cAC5B,UAAU;AAAA,cACV,cAAc,sBAAsB,SAAS;AAAA,YAC/C,CAAC;AAAA,UACH;AAAA,QACF,CAAC;AAAA,MACH,OAEK;AACH,iBAAS;AAAA,UACP,mBAAmB;AAAA,YACjB;AAAA,YACA;AAAA,YACA;AAAA,YACA,OAAO,UAAU,WAAW;AAAA,YAC5B;AAAA,YACA,cAAc,sBAAsB,SAAS;AAAA,YAC7C,SAAS;AAAA,YACT,UAAU;AAAA,UACZ,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF,CAAC;AAAA,EACH,CAAC;AAED,SAAO;AACT;",
  "names": []
}
