import { getResolvedRef } from "../../helpers/get-resolved-ref.js";
import { getTag } from "../../navigation/helpers/get-tag.js";
const createSchemaEntry = ({
  ref,
  name,
  generateId,
  parentTag,
  _schema,
  parentId
}) => {
  const id = generateId({ name, type: "model", parentTag, parentId, schema: _schema });
  const schema = getResolvedRef(_schema);
  const title = schema && "title" in schema && schema.title || name;
  const entry = {
    id,
    title,
    name,
    ref,
    type: "model"
  };
  return entry;
};
const traverseSchemas = ({
  document,
  tagsMap,
  generateId,
  documentId
}) => {
  const schemas = document.components?.schemas ?? {};
  const untagged = [];
  for (const name in schemas) {
    const schema = getResolvedRef(schemas[name]);
    if (schema?.["x-internal"] || schema?.["x-scalar-ignore"] || !Object.hasOwn(schemas, name)) {
      continue;
    }
    const ref = `#/components/schemas/${name}`;
    if (schema?.["x-tags"]) {
      schema["x-tags"].forEach((tagName) => {
        const { tag, id: tagId } = getTag({ tagsMap, name: tagName, documentId, generateId });
        tagsMap.get(tagName)?.entries.push(
          createSchemaEntry({
            ref,
            name,
            generateId,
            parentTag: { tag, id: tagId },
            parentId: documentId
          })
        );
      });
    } else {
      untagged.push(
        createSchemaEntry({
          ref,
          name,
          generateId,
          _schema: getResolvedRef(schemas[name]),
          parentId: documentId
        })
      );
    }
  }
  return untagged;
};
export {
  traverseSchemas
};
//# sourceMappingURL=traverse-schemas.js.map
