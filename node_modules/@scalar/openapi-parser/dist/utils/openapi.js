import{dereference as r}from"./dereference.js";import{details as o}from"./details.js";import{filter as t}from"./filter.js";import{getEntrypoint as n}from"./getEntrypoint.js";import{load as e}from"./load/load.js";import{toJson as i}from"./toJson.js";import{toYaml as s}from"./toYaml.js";import{upgrade as a}from"./upgrade.js";import{validate as f}from"./validate.js";import{workThroughQueue as c}from"./workThroughQueue.js";function l(r){return{load:(o,t)=>function(r,o){const t={specification:r,tasks:[{action:e,options:{plugins:o?.plugins}}]};return{get:()=>w(t),files:()=>E(t),details:()=>O(t),filter:r=>h(t,r,{throwOnError:o?.throwOnError}),upgrade:()=>u(t,{throwOnError:o?.throwOnError}),validate:r=>p(t,{throwOnError:r?.throwOnError??o?.throwOnError}),dereference:r=>m(t,{...o??{},...r??{}}),toJson:()=>d(t),toYaml:()=>g(t)}}(o,{...r??{},...t??{}})}}function u(r,o){return r.tasks.push({action:a}),{get:()=>w(r),files:()=>E(r),details:()=>O(r),filter:t=>h(r,t,{throwOnError:o?.throwOnError}),validate:t=>p(r,{throwOnError:t?.throwOnError??o?.throwOnError}),dereference:t=>m(r,{...o??{},...t??{}}),toJson:()=>d(r),toYaml:()=>g(r)}}function p(r,o){return r.tasks.push({action:f,options:{throwOnError:o?.throwOnError}}),{filter:t=>h(r,t,{throwOnError:o?.throwOnError}),get:()=>w(r),files:()=>E(r),details:()=>O(r),dereference:t=>m(r,{...o??{},...t??{}}),toJson:()=>d(r),toYaml:()=>g(r)}}function m(o,t){return o.tasks.push({action:r,options:{throwOnError:t?.throwOnError}}),{get:()=>w(o),files:()=>E(o),filter:r=>h(o,r,{throwOnError:t?.throwOnError}),toJson:()=>d(o),toYaml:()=>g(o)}}function h(r,o,n){return r.tasks.push({action:t,options:o}),{get:()=>w(r),files:()=>E(r),details:()=>O(r),filter:()=>h(r,o,n),upgrade:()=>u(r,n),validate:o=>p(r,{throwOnError:o?.throwOnError??n?.throwOnError}),dereference:o=>m(r,{...n??{},...o??{}}),toJson:()=>d(r),toYaml:()=>g(r)}}async function w(r){const o=await c(r);return void 0===o.specification&&(o.specification=n(o.filesystem).specification),o}async function E(r){const{filesystem:o}=await c(r);return o}async function O(r){const{filesystem:t}=await c(r);return o(n(t).specification)}async function d(r){const{filesystem:o}=await c(r);return i(n(o).specification)}async function g(r){const{filesystem:o}=await c(r);return s(n(o).specification)}export{l as openapi};
